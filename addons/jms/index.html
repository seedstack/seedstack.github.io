<!DOCTYPE html>
<html lang="en">
<head>
    
    


    


<title>
    JMS
</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">



<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/css/style.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/plugins/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="http://seedstack.org/css/style.css">



<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "http://seedstack.org",
  "logo": "http://seedstack.org/img/logos/seedstack.png"
}
</script>



<meta property="og:title" content='JMS' />
<meta property="og:description" content="Java Message Service (JMS) is a Java API that allows applications to create, send, receive, and read messages.
SeedStack JMS add-on provides a JMS 1.1 integration (JSR 914)." />
<meta property="og:url" content="http://seedstack.org/addons/jms/" />
<meta property="og:site_name" content="SeedStack" />
<meta property="og:image" content="http://seedstack.org/img/opengraph.png" />



<link rel="search" type="application/opensearchdescription+xml" href="http://seedstack.org/opensearch.xml" title="SeedStack" />



<link rel="apple-touch-icon" sizes="57x57" href="http://seedstack.org/img/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://seedstack.org/img/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://seedstack.org/img/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://seedstack.org/img/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://seedstack.org/img/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://seedstack.org/img/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://seedstack.org/img/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://seedstack.org/img/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://seedstack.org/img/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="http://seedstack.org/img/favicons/manifest.json">
<meta name="apple-mobile-web-app-title" content="SeedStack">
<meta name="application-name" content="SeedStack">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">



<script type="text/javascript">
    window.seedstack = {
        baseUrl: "http:\/\/seedstack.org\/",
        state: {}
    };
</script>


</head>
<body>

<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5R5FP9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5R5FP9');</script>


<div id="header">
    
    

<div class="header">
    <div class="container">
        <a class="logo" href="http://seedstack.org/">SeedStack</a>
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-bars"></span>
        </button>
    </div>
    <div class="collapse navbar-collapse navbar-responsive-collapse" data-role="navigation" style="pointer-events: none;">
        <div class="container">
            <ul class="nav navbar-nav" style="pointer-events: auto;">
                <li class=''>
                    <a href="http://seedstack.org/docs">Documentation</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/guides">Guides</a>
                </li>
                <li class='active'>
                    <a href="http://seedstack.org/addons">Add-ons</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/posts">News</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/community">Community</a>
                </li>
                <li class='dropdown '>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                        More
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="http://seedstack.org/glossary">Glossary</a></li>
                        <li><a href="http://seedstack.org/tags">Tags</a></li>
                        <li><a href="http://seedstack.org/project">Project info</a></li>
                        <li><a target="_blank" href="http://seedstack.org/javadoc"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Javadoc</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack/distribution/releases"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Releases</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> GitHub</a></li>
                    </ul>
                </li>
                <li>
                    <i class="search fa fa-search search-btn"></i>
                    <div class="search-open">
                        <form method="GET" action="http://seedstack.org/search">
                            <div class="input-group animated fadeInDown">
                                <input id="search-field" type="text" class="form-control" placeholder="Search" name="q">
                                <span class="input-group-btn">
                                    <button class="btn-u" type="submit">Go</button>
                                </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>


    <div class="title-header small">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <h1>Add-ons</h1>
                <p class="hidden-xs">Additional features and extensions for SeedStack applications.</p>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="header-image-wrapper">
                    <img class="header-image" src="http://seedstack.org/img/logos/addons-logo.svg">
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="title-subheader">
        <div class="container">
            <ul>
                <li><span><i class="fa fa-chevron-left"></i> <a href="http://seedstack.org/addons">Back to list</a></span></li>
                
            </ul>
        </div>
    </div>
</div>
<div id="content" class="container">
    <div class="row">
    
    <div class="col-md-12">
    
        <div class="content-wrapper">
            <div class="doc-content">
                <h1 class="nocount">JMS</h1>
                <p>Java Message Service (JMS) is a Java API that allows applications to create, send, receive, and read messages.
SeedStack JMS add-on provides a JMS 1.1 integration (JSR 914).</p>

<p>It automatically manages connection factories, connections, sessions and message consumers/listeners while retaining the
standard JMS API. It also transparently handles refresh of connections and sessions after a JMS failure.</p>

<h2 id="dependency">Dependency</h2>








    
        
            
        
    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-org-seedstack-addons-jms-jms-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-org-seedstack-addons-jms-jms-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-org-seedstack-addons-jms-jms-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;org.seedstack.addons.jms&lt;/groupId&gt;
    &lt;artifactId&gt;jms&lt;/artifactId&gt;<span id="org-seedstack-addons-jms-jms-version" style="display: none;">
    &lt;version&gt;3.1.1&lt;/version&gt;</span>
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="org-seedstack-addons-jms-jms-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: block;" id="org-seedstack-addons-jms-jms-show" onclick="$('#org-seedstack-addons-jms-jms-version, #org-seedstack-addons-jms-jms-warn').show(); $('#org-seedstack-addons-jms-jms-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-org-seedstack-addons-jms-jms-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    compile(&quot;org.seedstack.addons.jms:jms:3.1.1&quot;)
}</code></pre>
        </div>
    </div>
</div>


<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>JMS provider implementation is not provided by this add-on and must be configured depending on your messaging solution.</p>

        </div>
    </div>
</div>

<p>You may need to add the JMS specification dependency in modules that don&rsquo;t include the JMS provider:</p>






    



    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-javax-jms-jms-api-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-javax-jms-jms-api-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-javax-jms-jms-api-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;javax.jms&lt;/groupId&gt;
    &lt;artifactId&gt;jms-api&lt;/artifactId&gt;<span id="javax-jms-jms-api-version" >
    &lt;version&gt;1.1-rev-1&lt;/version&gt;</span>
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="javax-jms-jms-api-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: none;" id="javax-jms-jms-api-show" onclick="$('#javax-jms-jms-api-version, #javax-jms-jms-api-warn').show(); $('#javax-jms-jms-api-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-javax-jms-jms-api-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    (&quot;javax.jms:jms-api:1.1-rev-1&quot;)
}</code></pre>
        </div>
    </div>
</div>


<h2 id="configuration">Configuration</h2>

<h3 id="connection-factories">Connection factories</h3>


<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-jms-connectionsfactories-config" data-toggle="tab" aria-expanded="true">Configuration</a></li>
        <li class=""><a href="#tab-jms-connectionsfactories-dump" data-toggle="tab" aria-expanded="true">Tool</a></li>
    </ul>
    <span class="tabs-icon fa-2x fa fa-wrench pull-right"></span>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-jms-connectionsfactories-config"><pre><code class="language-yaml">jms:
  # Configured JMS connection factories with the name of the connection factory as key
  connectionFactories:
    connectionFactory1:
      # The fully qualified name of the provider ConnectionFactory implementation
      vendorClass: (Class&lt;? extends ConnectionFactory&gt;)

      # Bean properties that will be set on the provider ConnectionFactory implementation
      vendorProperties:
        beanProperty1: value1
      
      # The JNDI name of the connection factory (only when using JNDI, exclusive with vendorClass)  
      jndiName: (String)
      
      # The JNDI context where to lookup for the connection factory (only when using JNDI)  
      jndiContext: (String)
</code></pre>
</div>
        <div class="tab-pane in" id="tab-jms-connectionsfactories-dump">
            <p style="margin-top: 20px;">To dump the <code>jms.connectionsFactories</code> configuration options:</p>
            <pre><code class="language-bash">mvn -q -Dargs="jms.connectionsFactories" seedstack:config</code></pre>
        </div>
    </div>
</div>


<h3 id="connections">Connections</h3>


<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-jms-connections-config" data-toggle="tab" aria-expanded="true">Configuration</a></li>
        <li class=""><a href="#tab-jms-connections-dump" data-toggle="tab" aria-expanded="true">Tool</a></li>
    </ul>
    <span class="tabs-icon fa-2x fa fa-wrench pull-right"></span>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-jms-connections-config"><pre><code class="language-yaml">jms:
  # Configured JMS connections
  connections:
    connection1:
      # The name of the connection factory configured above to use
      connectionFactory: (String)
      
      # The client identifier to use for durable subscriptions (defaults to applicationId-connectionName if not specified)
      clientId: (String)
      
      # If true, the configured client id will be set on the connection  
      setClientId: (boolean)

      # The connection username if any
      user: (String)
      
      # The connection password if any 
      password: (String)
      
      # If true, the connection will attempt to reconnect automatically after a JMS failure  
      managed: (boolean)
      
      # The time in milliseconds to wait before trying the reconnect (in managed mode)
      reconnectionDelay: (int)

      # If true, JMS methods forbidden in a JEE environment will not be used
      jeeMode: (boolean)

      # The fully qualified name of the JMS exception listener class for this connection 
      exceptionListener: (Class&lt;? extends ExceptionListener&gt;)
      
      # The fully qualified name of the transaction exception handler for this connection
      exceptionHandler: (Class&lt;? extends JmsExceptionHandler&gt;)
</code></pre>
</div>
        <div class="tab-pane in" id="tab-jms-connections-dump">
            <p style="margin-top: 20px;">To dump the <code>jms.connections</code> configuration options:</p>
            <pre><code class="language-bash">mvn -q -Dargs="jms.connections" seedstack:config</code></pre>
        </div>
    </div>
</div>


<h3 id="jee-mode">JEE mode</h3>

<p>In a strict JEE environment, some JMS methods are forbidden (refer to the EE.6.7 section of the JavaEE platform specification).
When the JEE mode is enabled on a connection, the forbidden methods are not invoked.</p>

<p>The major downside is that it prevents using asynchronous message reception. SeedStack will use message polling instead,
so a message poller must be configured on the message listener when in JEE mode.</p>

<h3 id="example">Example</h3>

<h4 id="active-mq">Active MQ</h4>

<p>Assuming that we are using <a href="http://activemq.apache.org/">Apache ActiveMQ</a>, the following configuration declares a
JMS connection named <code>connection1</code> using the connection factory <code>connectionFactory1</code>:</p>

<pre><code class="language-yaml">jms:
  connectionFactories:
    connectionFactory1:
      vendorClass: org.apache.activemq.ActiveMQConnectionFactory
      vendorProperties:
        brokerURL: vm://localhost?broker.persistent=false
  connections:
    connection1:
      connectionFactory: connectionFactory1
</code></pre>

<h4 id="websphere-mq">WebSphere MQ</h4>

<p>The following configuration does the same on <a href="https://www.ibm.com/products/mq">IBM MQ</a> in client mode (TCP/IP):</p>

<pre><code class="language-yaml">jms:
  connectionFactories:
    connectionFactory1:
      vendorClass: com.ibm.mq.jms.MQConnectionFactory
      vendorProperties:
      	queueManager: ...
      	hostName: ...
      	channel: ...
      	port: 1414
      	transportType: 1        
  connections:
  	connection1:
  	  connectionFactory: connectionFactory1
</code></pre>

<h2 id="sending-messages">Sending messages</h2>

<h3 id="injecting-a-session">Injecting a session</h3>

<p>The simplest way to send messages is to inject a <code><a data-toggle="tooltip" data-html="true" title='javax.&amp;#8203;jms.&amp;#8203;Session' href='http://docs.oracle.com/javaee/7/api/javax/jms/Session.html'>Session</a></code>:</p>

<pre><code class="language-java">public class SomeClass {
    @Inject
    private Session session;

    @Override
    @Transactional
    @JmsConnection(&quot;connection1&quot;)
    public void sendMessage() {
        Destination queue = session.createQueue(&quot;queue1&quot;);
        MessageProducer producer = session.createProducer(queue);
        TextMessage message = session.createTextMessage();
        message.setText(stringMessage);
        producer.send(message);
    }
}
</code></pre>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>The session object is managed by SeedStack, its usage is thread-safe and there is no need to close it.</p>

        </div>
    </div>
</div>

<h3 id="injecting-a-connection">Injecting a connection</h3>

<p>For more control, a connection can be injected directly inject and used to manually create all needed objects to send a message.
In this case, only the connection is managed by SeedStack and you are responsible for properly closing the objects you
create:</p>

<pre><code class="language-java">public class SomeClass {
    @Inject
    @Named(&quot;connection1&quot;)
    private Connection connection;

    public void sendMessage(String stringMessage) throws JMSException {
        Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);
        try {
            Destination queue = session.createQueue(&quot;queue1&quot;);
            MessageProducer producer = session.createProducer(queue);
            TextMessage message = session.createTextMessage();
            message.setText(stringMessage);
            producer.send(message);
        } finally {
            session.close();
        }
    }
}
</code></pre>

<h3 id="automatic-reconnection">Automatic reconnection</h3>

<p>When you inject a session or a connection and managed mode is enabled for the connection, SeedStack will inject
managed objects which embed a reconnection mechanism.</p>

<p>On such objects, creating a producer or sending a message when the connection is down will throw a <code><a data-toggle="tooltip" data-html="true" title='javax.&amp;#8203;jms.&amp;#8203;JMSException' href='http://docs.oracle.com/javaee/7/api/javax/jms/JMSException.html'>JMSException</a></code>.
When the connection is up again, objects are refreshed automatically and can be used again. Note that it is still up to you to
handle the retry policy of the sent message.</p>

<h2 id="receiving-messages">Receiving messages</h2>

<p>To receive JMS messages, create a message listener class implementing the <code><a data-toggle="tooltip" data-html="true" title='javax.&amp;#8203;jms.&amp;#8203;MessageListener' href='http://docs.oracle.com/javaee/7/api/javax/jms/MessageListener.html'>MessageListener</a></code> interface
and annotated with <code><a data-toggle="tooltip" data-html="true" title='org.&amp;#8203;seedstack.&amp;#8203;jms.&amp;#8203;JmsMessageListener' href='http://seedstack.org/javadoc/org/seedstack/jms/JmsMessageListener.html'>@JmsMessageListener</a></code>:</p>

<pre><code class="language-java">@JmsMessageListener(connection = &quot;connection1&quot;, destinationName = &quot;SOME.QUEUE&quot;)
public class SomeMessageListener implements MessageListener {
    @Logging
    private Logger logger;

    @Override
    @Transactional
    public void onMessage(Message message) {
        if (message instanceof TextMessage) {
            logger.info(&quot;Message received {}&quot;, ((TextMessage) message).getText());
        } else {
            logger.warn(&quot;Unsupported message type&quot;);
        }
    }
}
</code></pre>

<p>The <code><a data-toggle="tooltip" data-html="true" title='org.&amp;#8203;seedstack.&amp;#8203;jms.&amp;#8203;JmsMessageListener' href='http://seedstack.org/javadoc/org/seedstack/jms/JmsMessageListener.html'>@JmsMessageListener</a></code> annotation takes the following parameters:</p>

<ul>
<li>The <code>connection</code> parameter specifying the connection that will be used to receive the messages.</li>
<li>The <code>destinationType</code> parameter specifying what kind of destination the class will listen to (queue or topic).</li>
<li>The <code>destinationName</code> parameter specifying the name of the destination.</li>
<li>The <code>poller</code> parameter is optional and is used to enable polling on this listener.</li>
</ul>

<p>When a <code>poller</code> parameter is specified, no asynchronous message reception (i.e. driven by the JMS provider) is done. Message
polling is used instead.</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>Reception is automatically done in a transacted session if a <code><a data-toggle="tooltip" data-html="true" title='org.&amp;#8203;seedstack.&amp;#8203;seed.&amp;#8203;transaction.&amp;#8203;Transactional' href='http://seedstack.org/javadoc/org/seedstack/seed/transaction/Transactional.html'>@Transactional</a></code>
annotation is present on the <code>onMessage()</code> method or on the listener class.</p>

        </div>
    </div>
</div>

<h3 id="simple-message-poller">Simple message poller</h3>

<p>If polling is needed on a particular listener you may use the <code><a data-toggle="tooltip" data-html="true" title='org.&amp;#8203;seedstack.&amp;#8203;jms.&amp;#8203;pollers.&amp;#8203;SimpleMessagePoller' href='http://seedstack.org/javadoc/org/seedstack/jms/pollers/SimpleMessagePoller.html'>SimpleMessagePoller</a></code> class for
basic polling needs.</p>

<p>This poller spawns a thread which calls to <code>receive()</code> in a loop, dispatching the message to the <code>onMessage()</code> method when
a message is received. If an exception occurs during <code>receive()</code>, the exception is dispatched to the connection exception
listener if any.</p>

<p>If an exception is thrown during the reception or message handling, the polling thread is shutdown and scheduled to
restart 10 seconds later. When used in conjunction with the automatic reconnection, the exception also triggers a
connection refresh. In that case, the poller may retry to receive messages several times before the connection is up
again, depending on the configured connection refresh timeout.</p>

<h3 id="custom-poller">Custom poller</h3>

<p>A customer poller can be created by implementing the <code><a data-toggle="tooltip" data-html="true" title='org.&amp;#8203;seedstack.&amp;#8203;jms.&amp;#8203;MessagePoller' href='http://seedstack.org/javadoc/org/seedstack/jms/MessagePoller.html'>MessagePoller</a></code> interface:</p>

<pre><code class="language-java">public class MyMessagePoller implements MessagePoller {
    private Session session;
    private MessageConsumer messageConsumer;
    private ExceptionListener exceptionListener;
    private MessageListener messageListener;

    @Override
    public void setSession(Session session) {
        this.session = session;
    }

    @Override
    public void setMessageConsumer(MessageConsumer messageConsumer) {
        this.messageConsumer = messageConsumer;
    }

    @Override
    public void setExceptionListener(ExceptionListener exceptionListener) {
        this.exceptionListener = exceptionListener;
    }

    @Override
    public void setMessageListener(MessageListener messageListener) {
        this.messageListener = messageListener;
    }

    @Override
    public synchronized void start() {
        // TODO: start receiving loop
    }

    @Override
    public synchronized void stop() {
        // TODO: stop receiving loop

    }
}
</code></pre>
            </div>
        </div>
    </div>
</div>

</div>
<div id="toc">
    <div class="toc" data-spy="affix" data-offset-top="314" data-offset-bottom="336">
    <div>
        
    </div>
    <br/>
    <div>
        <p class="title">On this page</p>
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#dependency">Dependency</a></li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#connection-factories">Connection factories</a></li>
<li><a href="#connections">Connections</a></li>
<li><a href="#jee-mode">JEE mode</a></li>
<li><a href="#example">Example</a>
<ul>
<li><a href="#active-mq">Active MQ</a></li>
<li><a href="#websphere-mq">WebSphere MQ</a></li>
</ul></li>
</ul></li>
<li><a href="#sending-messages">Sending messages</a>
<ul>
<li><a href="#injecting-a-session">Injecting a session</a></li>
<li><a href="#injecting-a-connection">Injecting a connection</a></li>
<li><a href="#automatic-reconnection">Automatic reconnection</a></li>
</ul></li>
<li><a href="#receiving-messages">Receiving messages</a>
<ul>
<li><a href="#simple-message-poller">Simple message poller</a></li>
<li><a href="#custom-poller">Custom poller</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
    <br/>
    <div>
        
        
        
        <a href='https://github.com/seedstack/jms-addon/edit/docs/index.md' target="_blank"><i class="fa fa-edit"></i> Edit this page</a>
        
        
    </div>
</div>
</div>
<div id="footer">
    <a class="scrollup">Scroll</a>
<div class="footer-v3">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 md-margin-bottom-40">
                    <div class="headline"><h2>About</h2></div>
                    <p class="margin-bottom-25 md-margin-bottom-40">
                        SeedStack is an opinionated, easy-to-use Java development stack for building applications and micro-services.
                    </p>
                    <p>
                        <i class="fa fa-file-text"></i> <a target="_blank" href="http://seedstack.org/docs">Docs</a>
                        <i class="fa fa-info-circle"></i> <a target="_blank" href="http://seedstack.org/javadoc">Javadoc</a>
                        <i class="fa fa-book"></i> <a target="_blank" href="http://seedstack.org/guides">Guides</a>
                        <i class="fa fa-plug"></i> <a target="_blank" href="http://seedstack.org/addons">Add-ons</a>
                        <br/>
                        <i class="fa fa-keyboard-o"></i> <a style="cursor: pointer;" onclick="seedstack.ui.openHelp();">Keyboard shortcuts</a>
                    </p>
                </div>

                <div class="col-md-4 md-margin-bottom-40">
                    <div class="posts">
                        <div class="headline"><h2>License and credits</h2></div>
                        <p>
                            Code licensed under the <a href="https://www.mozilla.org/MPL/2.0" target="_blank">Mozilla Public License 2.0</a>.
                            <br/>
                            Documentation licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.
                            <br/>
                            Some illustrations by <a href="https://www.Vecteezy.com/">www.Vecteezy.com</a>
                        </p>
                    </div>
                </div>

                <div class="col-md-4 map-img">
                    <div class="headline"><h2>Contact us</h2></div>
                    <address>
                        <p>
                            <i class="fa fa-stack-overflow"></i> <a target="_blank" href="http://stackoverflow.com/questions/ask?tags=seedstack">StackOverflow</a>
                            <br/>
                            <i class="fa fa-comments"></i> <a target="_blank" href="https://kiwiirc.com/client/irc.freenode.net#seedstack">IRC</a>
                            <br/>
                            <i class="fa fa-github"></i> <a target="_blank" href="https://github.com/seedstack">GitHub</a>
                            <br/>
                            <i class="fa fa-link"></i> <a target="_blank" href="https://projects.ow2.org/bin/view/seedstack/">OW2</a>
                        </p>
                    </address>

                    <div class="headline"><h2>Stay in touch</h2></div>
                    <div style="margin-bottom: 20px;">
                        <a class="twitter-follow-button"
                           href="https://twitter.com/seedstack"
                           data-show-count="false"
                           data-size="large"
                           data-lang="en">
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>
<div id="hotkeys-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Keyboard shortcuts</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table class="keyboard-mappings">
                            <tbody>
                            <tr>
                                <td class="keys">
                                    <kbd>?</kbd>
                                </td>
                                <td>Show this help dialog</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>/</kbd>
                                </td>
                                <td>Focus the search field</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-left"></i></kbd>
                                </td>
                                <td>Go to previous page</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-right"></i></kbd>
                                </td>
                                <td>Go to next page</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>d</kbd>
                                </td>
                                <td>Go to documentation</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>a</kbd>
                                </td>
                                <td>Go to add-ons library</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>g</kbd>
                                </td>
                                <td>Go to guides list</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="versions-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 id="versions-title" class="modal-title">Fetching components...</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table id="versions-table" class="table table-striped table-hover table-bordered">
                            <tr>
                                <th>Component</th>
                                <th>Version</th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/idea.min.css">

<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/gradle.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.1.0/highlightjs-line-numbers.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/seedstack.js"></script>
<script>
    $(document).ready(function () {
        var $search = $('.search-btn');

        $('.search').click(function () {
            if ($search.hasClass('fa-search')) {
                seedstack.ui.openSearch();
            } else {
                seedstack.ui.closeSearch();
            }
        });

        function hideJavaImports(block) {
            $(block).filter('.language-java')
                .find('table > tbody > tr')
                .each(function (i, javaLine) {
                    var $javaLine = $(javaLine);
                    var code = $javaLine.find("td.hljs-ln-code div.hljs-ln-line").text();
                    if (/^package/.test(code) || /^import/.test(code) || code.trim().length === 0) {
                        $javaLine.hide();
                    } else {
                        return false;
                    }
                });
        }

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);

            if ($(block).not('.no-linenums').length > 0) {
                hljs.lineNumbersBlock(block);
                
                var lastLine = $(block).find('table > tbody > tr:last');
                if (lastLine.text().trim() === "") {
                    lastLine.remove();
                }
            }

            
            hideJavaImports(block);
        });

        
        $('.doc-content h2, .doc-content h3').each(function () {
            $(this).append(" <a class='title-anchor' href='#" + this.id + "'>#</a>");
        });

        Mousetrap.bind('/', function () {
            seedstack.ui.openSearch();
            return false;
        });

        Mousetrap.bind('left', function () {
            if (seedstack.state.previousPage) {
                window.location = seedstack.state.previousPage;
            }
            return false;
        });

        Mousetrap.bind('right', function () {
            if (seedstack.state.nextPage) {
                window.location = seedstack.state.nextPage;
            }
            return false;
        });

        Mousetrap.bind('?', function () {
            seedstack.ui.openHelp();
            return false;
        });

        Mousetrap.bind('esc', function () {
            seedstack.ui.closeHelp();
            seedstack.ui.closeSearch();
            seedstack.ui.closeVersions();
            return false;
        });

        var originalCallback = Mousetrap.stopCallback;
        Mousetrap.stopCallback = function (e, element, combo) {
            if (combo === 'esc') {
                return false;
            }

            return originalCallback(e, element, combo);
        };

        function bindShortcuts(value) {
            $.each(value, function (sequence, item) {
                if (typeof item === 'string') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item;
                        return false;
                    });
                } else if (typeof item === 'object') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item.path;
                        return false;
                    });
                    if (item.shortcuts && location.pathname.indexOf(item.path) === 0) {
                        bindShortcuts(item.shortcuts);
                    }
                }
            });
        }

        bindShortcuts(seedstack.ui.shortcuts);

        $('.quick-paste span').each(function (index, element) {
            $(element).attr({"id": "quick-paste-line"});
            $(element).append("<span data-toggle=\"tooltip\" data-placement=\"top\" data-title=\"Copy\" data-clipboard-target=\"#quick-paste-line\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var preId = 0;
        $('.doc-content pre').each(function (index, element) {
            preId++;
            $(element).attr({"id": "snippet-" + preId});
            $(element).prepend("<span data-toggle=\"tooltip\" data-placement=\"left\" data-title=\"Copy\" data-clipboard-target=\"#snippet-" + preId + "\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var clipboard = new Clipboard('.copy-button', {
            target: function (trigger) {
                var elt = $($(trigger).data('clipboard-target'));
                elt.find('code > table > tbody > tr').show();
                return elt.get(0);
            }
        });
        clipboard.on('success', function (e) {
            var elt = $($(e.trigger).data('clipboard-target'));
            hideJavaImports($(elt).children("code"));

            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=14px');
            tooltip.children(".tooltip-inner").html("Copied!");
            e.clearSelection();
        });
        clipboard.on('error', function (e) {
            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=83px');
            tooltip.children(".tooltip-inner").html("Error! Copy manually");
        });

        $('[data-toggle="tooltip"]').tooltip({
            container: 'body'
        });

        $('#hotkeys-modal, #versions-modal').bind('hidden.bs.modal', function () {
            $("html").css("margin-right", "0px");
        }).bind('show.bs.modal', function () {
            $("html").css("margin-right", "-15px");
        });

        var query = seedstack.strings.parseQueryString(location);
        if (query.h && query.h.length > 0) {
            $('.doc-content').highlight(query.h);
            if (query.scroll) {
                var firstOccurence = $('span[class=highlight]:first');
                if (firstOccurence.length > 0) {
                    $('html, body').animate({
                        scrollTop: firstOccurence.offset().top - 20
                    }, 250);
                }
            }
        }

        $(window).scroll(function () {
            if ($(this).scrollTop() > 200) {
                $('.scrollup').fadeIn();
            } else {
                $('.scrollup').fadeOut();
            }
        });

        $('.scrollup').click(function () {
            $("html, body").animate({scrollTop: 0}, 250);
            return false;
        });
    });
</script>
<script>window.twttr = (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
    t._e = [];
    t.ready = function (f) {
        t._e.push(f);
    };
    return t;
}(document, "script", "twitter-wjs"));</script>

</body>
</html>
