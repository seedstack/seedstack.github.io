<!DOCTYPE html>
<html lang="en">
<head>
    
    


    


<title>
    MongoDB
</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">



<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/css/style.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/plugins/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="http://seedstack.org/css/style.css">



<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "http://seedstack.org",
  "logo": "http://seedstack.org/img/logos/seedstack.png"
}
</script>



<meta property="og:title" content='MongoDB' />
<meta property="og:description" content="SeedStack MongoDB add-on provides integration of MongoDB Java clients your application to connect with MongoDB instances.
" />
<meta property="og:url" content="http://seedstack.org/addons/mongodb/" />
<meta property="og:site_name" content="SeedStack" />
<meta property="og:image" content="http://seedstack.org/img/opengraph.png" />



<link rel="search" type="application/opensearchdescription+xml" href="http://seedstack.org/opensearch.xml" title="SeedStack" />



<link rel="apple-touch-icon" sizes="57x57" href="http://seedstack.org/img/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://seedstack.org/img/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://seedstack.org/img/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://seedstack.org/img/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://seedstack.org/img/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://seedstack.org/img/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://seedstack.org/img/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://seedstack.org/img/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://seedstack.org/img/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="http://seedstack.org/img/favicons/manifest.json">
<meta name="apple-mobile-web-app-title" content="SeedStack">
<meta name="application-name" content="SeedStack">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">



<script type="text/javascript">
    window.seedstack = {
        baseUrl: "http:\/\/seedstack.org\/",
        state: {}
    };
</script>


</head>
<body>

<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5R5FP9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5R5FP9');</script>


<div id="header">
    
    

<div class="header">
    <div class="container">
        <a class="logo" href="http://seedstack.org/">SeedStack</a>
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-bars"></span>
        </button>
    </div>
    <div class="collapse navbar-collapse navbar-responsive-collapse" data-role="navigation" style="pointer-events: none;">
        <div class="container">
            <ul class="nav navbar-nav" style="pointer-events: auto;">
                <li class=''>
                    <a href="http://seedstack.org/docs">Documentation</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/guides">Guides</a>
                </li>
                <li class='active'>
                    <a href="http://seedstack.org/addons">Add-ons</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/posts">News</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/community">Community</a>
                </li>
                <li class='dropdown '>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                        More
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="http://seedstack.org/glossary">Glossary</a></li>
                        <li><a href="http://seedstack.org/tags">Tags</a></li>
                        <li><a href="http://seedstack.org/project">Project info</a></li>
                        <li><a target="_blank" href="http://seedstack.org/javadoc"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Javadoc</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack/distribution/releases"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Releases</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> GitHub</a></li>
                    </ul>
                </li>
                <li>
                    <i class="search fa fa-search search-btn"></i>
                    <div class="search-open">
                        <form method="GET" action="http://seedstack.org/search">
                            <div class="input-group animated fadeInDown">
                                <input id="search-field" type="text" class="form-control" placeholder="Search" name="q">
                                <span class="input-group-btn">
                                    <button class="btn-u" type="submit">Go</button>
                                </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>


    <div class="title-header small">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <h1>Add-ons</h1>
                <p class="hidden-xs">Additional features and extensions for SeedStack applications.</p>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="header-image-wrapper">
                    <img class="header-image" src="http://seedstack.org/img/logos/addons-logo.svg">
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="title-subheader">
        <div class="container">
            <ul>
                <li><span><i class="fa fa-chevron-left"></i> <a href="http://seedstack.org/addons">Back to list</a></span></li>
                
                <li class="pull-right">
                    <span class="menu-toggle" style="" data-toggle="collapse" data-target=".side-menu-collapse">
    <span class="sr-only">Toggle menu</span>
    <i class="fa fa-bars"></i>
</span>

                </li>
                
            </ul>
        </div>
    </div>
</div>
<div id="content" class="container">
    <div class="row">
    
    <div class="col-md-3">
        










<nav class="side-menu collapse side-menu-collapse" data-role="navigation">
    <div class="list-group">
        <ul class="nav">
            
            
            <li class="list-group-header">
                <a href="/addons/mongodb/" class=" active" data-target=".contents">Contents</a>
            </li>
            
            <li class="list-group-item">
                <ul>
                    
                    
                    <li>
                        
                        <a href="/addons/mongodb/" class="active">
                            MongoDB
                        </a>
                        
                    </li>
                    
                    
                        
                        
                    
                    
                    
                    
                    <li>
                        
                        <a href="/addons/mongodb/morphia/" class="">
                            Morphia
                        </a>
                        
                    </li>
                    
                        
                        
                        <script>
                            seedstack.state.nextPage = '\/addons\/mongodb\/morphia\/';
                        </script>
                    
                    
                    
                    
                </ul>
            </li>
            
            </li>
            
        </ul>
    </div>
</nav>



    </div>
    <div class="col-md-9">
    
        <div class="content-wrapper">
            <div class="doc-content">
                <h1 class="nocount">MongoDB</h1>
                <p>SeedStack MongoDB add-on provides integration of MongoDB Java clients your application to connect with MongoDB instances.
</p>

<h2 id="dependencies">Dependencies</h2>

<p>Add the following dependency:</p>








    
        
            
        
    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-org-seedstack-addons-mongodb-mongodb-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-org-seedstack-addons-mongodb-mongodb-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-org-seedstack-addons-mongodb-mongodb-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;org.seedstack.addons.mongodb&lt;/groupId&gt;
    &lt;artifactId&gt;mongodb&lt;/artifactId&gt;<span id="org-seedstack-addons-mongodb-mongodb-version" style="display: none;">
    &lt;version&gt;3.1.3&lt;/version&gt;</span>
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="org-seedstack-addons-mongodb-mongodb-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: block;" id="org-seedstack-addons-mongodb-mongodb-show" onclick="$('#org-seedstack-addons-mongodb-mongodb-version, #org-seedstack-addons-mongodb-mongodb-warn').show(); $('#org-seedstack-addons-mongodb-mongodb-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-org-seedstack-addons-mongodb-mongodb-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    compile(&quot;org.seedstack.addons.mongodb:mongodb:3.1.3&quot;)
}</code></pre>
        </div>
    </div>
</div>


<p>You also need to add the MongoDB Java client:</p>








    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-org-mongodb-mongo-java-driver-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-org-mongodb-mongo-java-driver-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-org-mongodb-mongo-java-driver-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;org.mongodb&lt;/groupId&gt;
    &lt;artifactId&gt;mongo-java-driver&lt;/artifactId&gt;<span id="org-mongodb-mongo-java-driver-version" >
    &lt;version&gt;...&lt;/version&gt;</span>
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="org-mongodb-mongo-java-driver-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: none;" id="org-mongodb-mongo-java-driver-show" onclick="$('#org-mongodb-mongo-java-driver-version, #org-mongodb-mongo-java-driver-warn').show(); $('#org-mongodb-mongo-java-driver-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-org-mongodb-mongo-java-driver-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    compile(&quot;org.mongodb:mongo-java-driver:...&quot;)
}</code></pre>
        </div>
    </div>
</div>


<p>You can choose to use the MongoDB asynchronous client instead (or in addition as you can mix asynchronous and synchronous
clients in the same application):</p>








    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-org-mongodb-mongodb-driver-async-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-org-mongodb-mongodb-driver-async-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-org-mongodb-mongodb-driver-async-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;org.mongodb&lt;/groupId&gt;
    &lt;artifactId&gt;mongodb-driver-async&lt;/artifactId&gt;<span id="org-mongodb-mongodb-driver-async-version" >
    &lt;version&gt;...&lt;/version&gt;</span>
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="org-mongodb-mongodb-driver-async-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: none;" id="org-mongodb-mongodb-driver-async-show" onclick="$('#org-mongodb-mongodb-driver-async-version, #org-mongodb-mongodb-driver-async-warn').show(); $('#org-mongodb-mongodb-driver-async-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-org-mongodb-mongodb-driver-async-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    compile(&quot;org.mongodb:mongodb-driver-async:...&quot;)
}</code></pre>
        </div>
    </div>
</div>


<h2 id="configuration">Configuration</h2>

<p>Configuration is done by declaring one or more clients:</p>


<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-mongodb-config" data-toggle="tab" aria-expanded="true">Configuration</a></li>
        <li class=""><a href="#tab-mongodb-dump" data-toggle="tab" aria-expanded="true">Tool</a></li>
    </ul>
    <span class="tabs-icon fa-2x fa fa-wrench pull-right"></span>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-mongodb-config"><pre><code class="language-yaml">mongoDb:
  # Configured clients with the name of the client as key
  clients:
    client1:
      # If true, the client is considered asynchronous (defaults to false)
      async: (boolean)
      # URI to connect the client to
      uri: (String)
      # List of hosts to connect the client to (only considered if no uri is specified)
      hosts: (List&lt;String&gt;)
      # Only when using hosts: list of credentials to use (formatted as '[authMechanism/]dbName:user:password')
      credentials: (List&lt;String&gt;)
      # Only for synchronous clients: options based on MongoClientOptions class
      options:
        ...
      # Only for asynchronous clients: options based on the various Settings classes
      settings:
        ...
      # Databases available through this client with the name of the database as key
      databases:
        db1:
          # If specified the database will be injectable through this alias instead of its original name
          # This is useful for database name collisions between multiple clients
          alias: (String)
</code></pre>
</div>
        <div class="tab-pane in" id="tab-mongodb-dump">
            <p style="margin-top: 20px;">To dump the <code>mongoDb</code> configuration options:</p>
            <pre><code class="language-bash">mvn -q -Dargs="mongoDb" seedstack:config</code></pre>
        </div>
    </div>
</div>


<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>As MongoDB has a different Java driver for synchronous and asynchronous clients, the type of a client will determine how
it can be configured and used. Clients use the <a href="http://mongodb.github.io/mongo-java-driver/3.0/driver/">synchronous driver</a>
by default, to switch to the <a href="http://mongodb.github.io/mongo-java-driver/3.0/driver-async/">asynchronous driver</a>, set
the <code>async</code> configuration property to <code>true</code>.</p>

        </div>
    </div>
</div>

<h3 id="uri-connection-string">URI connection string</h3>

<p>The <code>uri</code> property is formatted as below:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      uri: mongodb://[username:password@]host1[:port1][,host2[:port2],...[,hostN[:portN]]][/[database][?options]]      
</code></pre>

<p>URI allows to directly specify a set of options common to synchronous and asynchronous clients. More information about
the URI and its options can be found <a href="http://docs.mongodb.org/manual/reference/connection-string/">here</a>.</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>When no port is specified, the default MongoDB port is used (27017).</p>

        </div>
    </div>
</div>

<h3 id="explicit-hosts">Explicit hosts</h3>

<p>As an alternative a client can be configured by directly specifying the MongoDB host(s):</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      hosts: [ host1:27017, host2 ]      
</code></pre>

<p>In this case, the client options must be specified using additional properties, which a are different for synchronous and
asynchronous clients. See the <a href="#synchronous-client-options">Synchronous client options</a> and <a href="#asynchronous-client-options">Asynchronous client options</a>
sections below for more information.</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>When no port is specified, the default MongoDB port is used (27017).</p>

        </div>
    </div>
</div>

<p>When configuring the connection with explicit hosts, connection credentials can be specified as the following:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      hosts: [ host1:27017, host2 ]
      credentials: [ db1:user1:password1 ]           
</code></pre>

<p>This will authenticate with the username <code>user1</code> and the password <code>password1</code>. The user will be looked up in the <code>db1</code>
database. The authentication mechanism will be automatically selected. To force an authentication mechanism use the
following syntax:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      hosts: [ host1:27017, host2 ]
      credentials: [ mechanism/db1:user1:password1 ]           
</code></pre>

<p>The available authentication mechanisms are <code>PLAIN</code>, <code>MONGODB_CR</code>, <code>SCRAM_SHA_1</code>, <code>MONGODB_X509</code> and <code>GSSAPI</code>.</p>

<div class="callout callout-tips">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
                <i class="fa fa-lightbulb-o icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>It is recommended to avoid specifying the authentication mechanism as it will be automatically selected. Also note that
often, only one credential is enough.</p>

        </div>
    </div>
</div>

<h3 id="databases">Databases</h3>

<p>You can choose to inject and use the <code>MongoClient</code> object(s) directly and access the database(s) programmatically. As a
convenience, the add-on also allows to inject the <code>MongoDatabase</code> object(s) provided they are configured as follow:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      uri: ... 
      databases: [ db1, db2 ]
</code></pre>

<p>Each declared database can then be injected (see the <a href="#usage">usage</a> section to know how to inject them). Database names
must be unique across the application so you can encounter a situation when multiple configured clients may need to access
databases with the same name. In that case, you can use the alias feature. Consider the following clients:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      uri: ... 
      databases: [ db1, db2 ]
    client2:
      uri: ... 
      databases: [ db2, db3 ]
</code></pre>

<p>The database named <code>db2</code> exists in MongoDB instances accessed by both <code>client1</code> and <code>client2</code>. To resolve this ambiguity,
one of the <code>db2</code> databases must be aliased in the application:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      uri: ... 
      databases: [ db1, db2 ]
    client2:
      uri: ... 
      databases:
        db2:
          alias: db2bis
        db3:  
</code></pre>

<p>In this example, the <code>db2</code> database present on the MongoDB instance accessed by <code>client2</code> will be referred in the
application by the <code>db2bis</code> name. Note that you can use this feature even when there are no name collision.</p>

<h3 id="synchronous-client-options">Synchronous client options</h3>

<p>Additional options can be specified on <strong>synchronous</strong> clients with the <code>options</code> property of the client.</p>

<p>All the options from the <a href="http://api.mongodb.org/java/3.0/com/mongodb/MongoClientOptions.Builder.html">MongoClientOptions.Builder</a>
class are available. Each method of the builder translates to an option of the same name. Consider the following example:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      uri: ... 
      options:
        connectionsPerHost: 75
</code></pre>

<p>This will invoke the <code>connectionsPerHost()</code> method on the option builder with the value <code>75</code> converted to an integer.</p>

<div class="callout callout-tips">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
                <i class="fa fa-lightbulb-o icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>If you use an URI configuration, you can combine the URI options with the <code>options</code> property. The latter will<br />
will complement their URI counterpart and override them if present in both.</p>

        </div>
    </div>
</div>

<h3 id="asynchronous-client-options">Asynchronous client options</h3>

<p>Additional options can be specified on <strong>asynchronous</strong> clients with the <code>settings</code> property:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      async: true
      uri: ... 
      settings:
        namespace1: 
          setting1: value1
        namespace2:
          setting2: value2
          setting3: value3
</code></pre>

<p>All the settings from the <code>MongoClientSettings.Builder</code> builder and its sub-builders are available. Each sub-builder translates
to a setting namespace and each of the builders method translates to a particular setting. The list of the builders and
their corresponding namespace is:</p>

<table class="table table-striped">
<tbody>
<tr>
    <th>Namespace</th>
    <th>Builder</th>
</tr>
<tr>
    <td>cluster</td>
    <td><a href="http://api.mongodb.org/java/3.0/com/mongodb/connection/ClusterSettings.Builder.html">ClusterSettings.Builder</a></td>
</tr>
<tr>
    <td>connectionPool</td>
    <td><a href="http://api.mongodb.org/java/3.0/com/mongodb/connection/ConnectionPoolSettings.Builder.html">ConnectionPoolSettings.Builder</a></td>
</tr>
<tr>
    <td>socket</td>
    <td><a href="http://api.mongodb.org/java/3.0/com/mongodb/connection/SocketSettings.Builder.html">SocketSettings.Builder</a></td>
</tr>
<tr>
    <td>heartbeatSocket</td>
    <td><a href="http://api.mongodb.org/java/3.0/com/mongodb/connection/SocketSettings.Builder.html">SocketSettings.Builder</a></td>
</tr>
<tr>
    <td>server</td>
    <td><a href="http://api.mongodb.org/java/3.0/com/mongodb/connection/ServerSettings.Builder.html">ServerSettings.Builder</a></td>
</tr>
<tr>
    <td>ssl</td>
    <td><a href="http://api.mongodb.org/java/3.0/com/mongodb/connection/SslSettings.Builder.html">SslSettings.Builder</a></td>
</tr>
</tbody>
</table>

<p>Consider the following example:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    client1:
      async: true
      uri: ... 
      settings:
        connectionPool: 
          maxSize: 75
</code></pre>

<p>This will invoke the <code>maxSize()</code> method on a <code>ConnectionPoolSettings.Builder</code> instance with the value <code>75</code> converted to
an integer. This builder instance will in turn be be set on a <code>MongoClientSettings.Builder</code> instance via the <code>connectionPoolSettings()</code>
method.</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <ul>
<li>The global settings directly available on <code>MongoClientSettings.Builder</code> can be specified without namespace. More information
on the global builder <a href="http://api.mongodb.org/java/current/com/mongodb/async/client/MongoClientSettings.Builder.html">here</a>.</li>
<li>The <code>cluster.hosts</code> and <code>credentialList</code> settings are ignored since they are already mapped from the <code>hosts</code> and the
<code>credentials</code> properties.</li>
</ul>

        </div>
    </div>
</div>

<h2 id="usage">Usage</h2>

<p>As MongoDB does not support transactions, usage simply consists in injecting a <code>MongoClient</code> or a <code>MongoDatabase</code> object
and using it accordingly to the MongoDB documentation. As an example you can inject the client as the following:</p>

<pre><code class="language-java">public class SomeClass {
    @Inject
    @Named(&quot;client1&quot;)
    private MongoClient client1;
}
</code></pre>

<p>This will inject the configured MongoDB client named <code>client1</code>. You can also inject a database directly as the following:</p>

<pre><code class="language-java">public class SomeClass {
    @Inject
    @Named(&quot;db1&quot;)
    private MongoDatabase db1;
}
</code></pre>

<p>This will inject the configured MongoDB database named <code>db1</code>. Note that you must use the aliased name instead of the
real database name if you aliased it in the configuration (see the <a href="#databases">databases</a> section for information
about aliases).</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <ul>
<li>If your client or database is configured as synchronous (the default) you must inject the <code>com.mongodb.MongoClient</code> and
<code>com.mongodb.client.MongoDatabase</code> classes.</li>
<li>If your client or database is configured as asynchronous, you must inject the <code>com.mongodb.async.client.MongoClient</code> and
<code>com.mongodb.async.client.MongoDatabase</code> classes instead.</li>
</ul>

        </div>
    </div>
</div>

<h2 id="recommendations">Recommendations</h2>

<h3 id="connection-timeout">Connection timeout</h3>

<p>The default configuration for the MongoDB driver is to make pooled connections stay forever alive, which may lead to
SocketException (&laquo;Connection timed up&raquo;) errors when connecting to remote/cloud MongoDB servers. This seems OK in a local
network context.</p>

<p>In a cloud context, remote DB servers (or intermediate network components) may kill the pooled connections after a period
of time. The application won&rsquo;t detect it until it tries to use the connection. The application will recover from the
error as the pool will be discarded and new connections will be open, but the ongoing operation that tried to use the
broken connection will fail and get lost in the process.</p>

<p>Using the connection option &laquo;maxIdleTimeMS&raquo; in the connection URI, or the client <code>options</code> yaml section will avoid this
kind of problem. Example of a URI setting this option:</p>

<pre><code class="language-yaml">mongoDb:
  clients:
    myClient:
      uri: mongodb://username:password@host:port/dbName?maxIdleTimeMS=120000
</code></pre>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>120 seconds is recommended in MongoDB documentation for the related <code>tcp_keepalive</code> problems, so it can safely be
applied to this option. See <a href="http://docs.mongodb.org/manual/reference/connection-string/#maxIdleTimeMS">http://docs.mongodb.org/manual/reference/connection-string/#maxIdleTimeMS</a></p>

        </div>
    </div>
</div>
            </div>
        </div>
    </div>
</div>

</div>
<div id="toc">
    <div class="toc" data-spy="affix" data-offset-top="314" data-offset-bottom="336">
    <div>
        
        <div>
            
            <i class="fa fa-chevron-left" style="color: #ccc;"></i>
            
            &nbsp;&nbsp;&nbsp;
            
            <a href='/addons/mongodb/morphia/' class="dib f6 pl1 hover-bg-light-gray br-100" data-toggle="tooltip" title='Morphia'>
                <i class="fa fa-chevron-right"></i>
            </a>
            
        </div>
        
    </div>
    <br/>
    <div>
        <p class="title">On this page</p>
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#configuration">Configuration</a>
<ul>
<li><a href="#uri-connection-string">URI connection string</a></li>
<li><a href="#explicit-hosts">Explicit hosts</a></li>
<li><a href="#databases">Databases</a></li>
<li><a href="#synchronous-client-options">Synchronous client options</a></li>
<li><a href="#asynchronous-client-options">Asynchronous client options</a></li>
</ul></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#recommendations">Recommendations</a>
<ul>
<li><a href="#connection-timeout">Connection timeout</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
    <br/>
    <div>
        
        
        
        <a href='https://github.com/seedstack/mongodb-addon/edit/docs/index.md' target="_blank"><i class="fa fa-edit"></i> Edit this page</a>
        
        
    </div>
</div>
</div>
<div id="footer">
    <a class="scrollup">Scroll</a>
<div class="footer-v3">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 md-margin-bottom-40">
                    <div class="headline"><h2>About</h2></div>
                    <p class="margin-bottom-25 md-margin-bottom-40">
                        SeedStack is an opinionated, easy-to-use Java development stack for building applications and micro-services.
                    </p>
                    <p>
                        <i class="fa fa-file-text"></i> <a target="_blank" href="http://seedstack.org/docs">Docs</a>
                        <i class="fa fa-info-circle"></i> <a target="_blank" href="http://seedstack.org/javadoc">Javadoc</a>
                        <i class="fa fa-book"></i> <a target="_blank" href="http://seedstack.org/guides">Guides</a>
                        <i class="fa fa-plug"></i> <a target="_blank" href="http://seedstack.org/addons">Add-ons</a>
                        <br/>
                        <i class="fa fa-keyboard-o"></i> <a style="cursor: pointer;" onclick="seedstack.ui.openHelp();">Keyboard shortcuts</a>
                    </p>
                </div>

                <div class="col-md-4 md-margin-bottom-40">
                    <div class="posts">
                        <div class="headline"><h2>License and credits</h2></div>
                        <p>
                            Code licensed under the <a href="https://www.mozilla.org/MPL/2.0" target="_blank">Mozilla Public License 2.0</a>.
                            <br/>
                            Documentation licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.
                            <br/>
                            Some illustrations by <a href="https://www.Vecteezy.com/">www.Vecteezy.com</a>
                        </p>
                    </div>
                </div>

                <div class="col-md-4 map-img">
                    <div class="headline"><h2>Contact us</h2></div>
                    <address>
                        <p>
                            <i class="fa fa-stack-overflow"></i> <a target="_blank" href="http://stackoverflow.com/questions/ask?tags=seedstack">StackOverflow</a>
                            <br/>
                            <i class="fa fa-comments"></i> <a target="_blank" href="https://kiwiirc.com/client/irc.freenode.net#seedstack">IRC</a>
                            <br/>
                            <i class="fa fa-github"></i> <a target="_blank" href="https://github.com/seedstack">GitHub</a>
                            <br/>
                            <i class="fa fa-link"></i> <a target="_blank" href="https://projects.ow2.org/bin/view/seedstack/">OW2</a>
                        </p>
                    </address>

                    <div class="headline"><h2>Stay in touch</h2></div>
                    <div style="margin-bottom: 20px;">
                        <a class="twitter-follow-button"
                           href="https://twitter.com/seedstack"
                           data-show-count="false"
                           data-size="large"
                           data-lang="en">
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>
<div id="hotkeys-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Keyboard shortcuts</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table class="keyboard-mappings">
                            <tbody>
                            <tr>
                                <td class="keys">
                                    <kbd>?</kbd>
                                </td>
                                <td>Show this help dialog</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>/</kbd>
                                </td>
                                <td>Focus the search field</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-left"></i></kbd>
                                </td>
                                <td>Go to previous page</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-right"></i></kbd>
                                </td>
                                <td>Go to next page</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>d</kbd>
                                </td>
                                <td>Go to documentation</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>a</kbd>
                                </td>
                                <td>Go to add-ons library</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>g</kbd>
                                </td>
                                <td>Go to guides list</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="versions-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 id="versions-title" class="modal-title">Fetching components...</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table id="versions-table" class="table table-striped table-hover table-bordered">
                            <tr>
                                <th>Component</th>
                                <th>Version</th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/idea.min.css">

<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/gradle.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.1.0/highlightjs-line-numbers.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/seedstack.js"></script>
<script>
    $(document).ready(function () {
        var $search = $('.search-btn');

        $('.search').click(function () {
            if ($search.hasClass('fa-search')) {
                seedstack.ui.openSearch();
            } else {
                seedstack.ui.closeSearch();
            }
        });

        function hideJavaImports(block) {
            $(block).filter('.language-java')
                .find('table > tbody > tr')
                .each(function (i, javaLine) {
                    var $javaLine = $(javaLine);
                    var code = $javaLine.find("td.hljs-ln-code div.hljs-ln-line").text();
                    if (/^package/.test(code) || /^import/.test(code) || code.trim().length === 0) {
                        $javaLine.hide();
                    } else {
                        return false;
                    }
                });
        }

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);

            if ($(block).not('.no-linenums').length > 0) {
                hljs.lineNumbersBlock(block);
                
                var lastLine = $(block).find('table > tbody > tr:last');
                if (lastLine.text().trim() === "") {
                    lastLine.remove();
                }
            }

            
            hideJavaImports(block);
        });

        
        $('.doc-content h2, .doc-content h3').each(function () {
            $(this).append(" <a class='title-anchor' href='#" + this.id + "'>#</a>");
        });

        Mousetrap.bind('/', function () {
            seedstack.ui.openSearch();
            return false;
        });

        Mousetrap.bind('left', function () {
            if (seedstack.state.previousPage) {
                window.location = seedstack.state.previousPage;
            }
            return false;
        });

        Mousetrap.bind('right', function () {
            if (seedstack.state.nextPage) {
                window.location = seedstack.state.nextPage;
            }
            return false;
        });

        Mousetrap.bind('?', function () {
            seedstack.ui.openHelp();
            return false;
        });

        Mousetrap.bind('esc', function () {
            seedstack.ui.closeHelp();
            seedstack.ui.closeSearch();
            seedstack.ui.closeVersions();
            return false;
        });

        var originalCallback = Mousetrap.stopCallback;
        Mousetrap.stopCallback = function (e, element, combo) {
            if (combo === 'esc') {
                return false;
            }

            return originalCallback(e, element, combo);
        };

        function bindShortcuts(value) {
            $.each(value, function (sequence, item) {
                if (typeof item === 'string') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item;
                        return false;
                    });
                } else if (typeof item === 'object') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item.path;
                        return false;
                    });
                    if (item.shortcuts && location.pathname.indexOf(item.path) === 0) {
                        bindShortcuts(item.shortcuts);
                    }
                }
            });
        }

        bindShortcuts(seedstack.ui.shortcuts);

        $('.quick-paste span').each(function (index, element) {
            $(element).attr({"id": "quick-paste-line"});
            $(element).append("<span data-toggle=\"tooltip\" data-placement=\"top\" data-title=\"Copy\" data-clipboard-target=\"#quick-paste-line\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var preId = 0;
        $('.doc-content pre').each(function (index, element) {
            preId++;
            $(element).attr({"id": "snippet-" + preId});
            $(element).prepend("<span data-toggle=\"tooltip\" data-placement=\"left\" data-title=\"Copy\" data-clipboard-target=\"#snippet-" + preId + "\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var clipboard = new Clipboard('.copy-button', {
            target: function (trigger) {
                var elt = $($(trigger).data('clipboard-target'));
                elt.find('code > table > tbody > tr').show();
                return elt.get(0);
            }
        });
        clipboard.on('success', function (e) {
            var elt = $($(e.trigger).data('clipboard-target'));
            hideJavaImports($(elt).children("code"));

            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=14px');
            tooltip.children(".tooltip-inner").html("Copied!");
            e.clearSelection();
        });
        clipboard.on('error', function (e) {
            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=83px');
            tooltip.children(".tooltip-inner").html("Error! Copy manually");
        });

        $('[data-toggle="tooltip"]').tooltip({
            container: 'body'
        });

        $('#hotkeys-modal, #versions-modal').bind('hidden.bs.modal', function () {
            $("html").css("margin-right", "0px");
        }).bind('show.bs.modal', function () {
            $("html").css("margin-right", "-15px");
        });

        var query = seedstack.strings.parseQueryString(location);
        if (query.h && query.h.length > 0) {
            $('.doc-content').highlight(query.h);
            if (query.scroll) {
                var firstOccurence = $('span[class=highlight]:first');
                if (firstOccurence.length > 0) {
                    $('html, body').animate({
                        scrollTop: firstOccurence.offset().top - 20
                    }, 250);
                }
            }
        }

        $(window).scroll(function () {
            if ($(this).scrollTop() > 200) {
                $('.scrollup').fadeIn();
            } else {
                $('.scrollup').fadeOut();
            }
        });

        $('.scrollup').click(function () {
            $("html, body").animate({scrollTop: 0}, 250);
            return false;
        });
    });
</script>
<script>window.twttr = (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
    t._e = [];
    t.ready = function (f) {
        t._e.push(f);
    };
    return t;
}(document, "script", "twitter-wjs"));</script>

</body>
</html>
