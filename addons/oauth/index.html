<!DOCTYPE html>
<html lang="en">
<head>
    
    


    


<title>
    OAuth
</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">



<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/css/style.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/plugins/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="http://seedstack.org/css/style.css">



<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "http://seedstack.org",
  "logo": "http://seedstack.org/img/logos/seedstack.png"
}
</script>



<meta property="og:title" content='OAuth' />
<meta property="og:description" content="Seedstack OAuth add-on provides the ability to authenticate and authorize subjects using OAuth and OpenID Connect.
Dependencies Maven Gradle   &lt;dependency&gt; &lt;groupId&gt;org.seedstack.addons.oauth&lt;/groupId&gt; &lt;artifactId&gt;oauth&lt;/artifactId&gt;&lt;version&gt;3.3.0&lt;/version&gt; &lt;/dependency&gt;  Specifying versions manually is error-prone, use dependency management instead. Show version   dependencies { compile(&quot;org.seedstack.addons.oauth:oauth:3.3.0&quot;) }    In a Web context you also need to add the following dependency (otherwise security filters will be ignored):
Maven Gradle   &lt;dependency&gt; &lt;groupId&gt;org." />
<meta property="og:url" content="http://seedstack.org/addons/oauth/" />
<meta property="og:site_name" content="SeedStack" />
<meta property="og:image" content="http://seedstack.org/img/opengraph.png" />



<link rel="search" type="application/opensearchdescription+xml" href="http://seedstack.org/opensearch.xml" title="SeedStack" />



<link rel="apple-touch-icon" sizes="57x57" href="http://seedstack.org/img/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://seedstack.org/img/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://seedstack.org/img/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://seedstack.org/img/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://seedstack.org/img/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://seedstack.org/img/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://seedstack.org/img/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://seedstack.org/img/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://seedstack.org/img/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="http://seedstack.org/img/favicons/manifest.json">
<meta name="apple-mobile-web-app-title" content="SeedStack">
<meta name="application-name" content="SeedStack">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">



<script type="text/javascript">
    window.seedstack = {
        baseUrl: "http:\/\/seedstack.org\/",
        state: {}
    };
</script>


</head>
<body>

<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5R5FP9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5R5FP9');</script>


<div id="header">
    
    

<div class="header">
    <div class="container">
        <a class="logo" href="http://seedstack.org/">SeedStack</a>
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-bars"></span>
        </button>
    </div>
    <div class="collapse navbar-collapse navbar-responsive-collapse" data-role="navigation" style="pointer-events: none;">
        <div class="container">
            <ul class="nav navbar-nav" style="pointer-events: auto;">
                <li class=''>
                    <a href="http://seedstack.org/docs">Documentation</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/guides">Guides</a>
                </li>
                <li class='active'>
                    <a href="http://seedstack.org/addons">Add-ons</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/posts">News</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/community">Community</a>
                </li>
                <li class='dropdown '>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                        More
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="http://seedstack.org/glossary">Glossary</a></li>
                        <li><a href="http://seedstack.org/tags">Tags</a></li>
                        <li><a href="http://seedstack.org/project">Project info</a></li>
                        <li><a target="_blank" href="http://seedstack.org/javadoc"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Javadoc</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack/distribution/releases"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Releases</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> GitHub</a></li>
                    </ul>
                </li>
                <li>
                    <i class="search fa fa-search search-btn"></i>
                    <div class="search-open">
                        <form method="GET" action="http://seedstack.org/search">
                            <div class="input-group animated fadeInDown">
                                <input id="search-field" type="text" class="form-control" placeholder="Search" name="q">
                                <span class="input-group-btn">
                                    <button class="btn-u" type="submit">Go</button>
                                </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>


    <div class="title-header small">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <h1>Add-ons</h1>
                <p class="hidden-xs">Additional features and extensions for SeedStack applications.</p>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="header-image-wrapper">
                    <img class="header-image" src="http://seedstack.org/img/logos/addons-logo.svg">
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="title-subheader">
        <div class="container">
            <ul>
                <li><span><i class="fa fa-chevron-left"></i> <a href="http://seedstack.org/addons">Back to list</a></span></li>
                
            </ul>
        </div>
    </div>
</div>
<div id="content" class="container">
    <div class="row">
    
    <div class="col-md-12">
    
        <div class="content-wrapper">
            <div class="doc-content">
                <h1 class="nocount">OAuth</h1>
                

<p>Seedstack OAuth add-on provides the ability to authenticate and authorize subjects using OAuth and OpenID Connect.</p>

<h2 id="dependencies">Dependencies</h2>








    
        
            
        
    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-org-seedstack-addons-oauth-oauth-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-org-seedstack-addons-oauth-oauth-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-org-seedstack-addons-oauth-oauth-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;org.seedstack.addons.oauth&lt;/groupId&gt;
    &lt;artifactId&gt;oauth&lt;/artifactId&gt;<span id="org-seedstack-addons-oauth-oauth-version" style="display: none;">
    &lt;version&gt;3.3.0&lt;/version&gt;</span>
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="org-seedstack-addons-oauth-oauth-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: block;" id="org-seedstack-addons-oauth-oauth-show" onclick="$('#org-seedstack-addons-oauth-oauth-version, #org-seedstack-addons-oauth-oauth-warn').show(); $('#org-seedstack-addons-oauth-oauth-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-org-seedstack-addons-oauth-oauth-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    compile(&quot;org.seedstack.addons.oauth:oauth:3.3.0&quot;)
}</code></pre>
        </div>
    </div>
</div>


<p>In a Web context you also need to add the following dependency (otherwise security filters will be ignored):</p>








    
        
            
        
    

<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-org-seedstack-seed-seed-web-security-maven" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/maven.png">Maven</a></li>
        <li class=""><a href="#tab-org-seedstack-seed-seed-web-security-gradle" data-toggle="tab" aria-expanded="true"><img class="pull-left" style="margin: 0 5px 0 0; height: 20px;" src="http://seedstack.org//img/logos/gradle.png">Gradle</a></li>
    </ul>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-org-seedstack-seed-seed-web-security-maven">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-xml no-linenums" style="background-color: #fff;">&lt;dependency&gt;
    &lt;groupId&gt;org.seedstack.seed&lt;/groupId&gt;
    &lt;artifactId&gt;seed-web-security&lt;/artifactId&gt;<span id="org-seedstack-seed-seed-web-security-version" style="display: none;">
    &lt;version&gt;3.15.1&lt;/version&gt;</span>
&lt;/dependency&gt;</code></pre>
            <small class="pull-right" style="color: #aaa; margin-top: -20px; margin-right: 5px;">
                <span id="org-seedstack-seed-seed-web-security-warn" style="display: none;"><i class="fa fa-warning" style="color: orange;"></i> Specifying versions manually is error-prone, use <a href="http://seedstack.org/docs/basics#dependency-management">dependency management</a> instead.</span>
                <a style="cursor: pointer; display: block;" id="org-seedstack-seed-seed-web-security-show" onclick="$('#org-seedstack-seed-seed-web-security-version, #org-seedstack-seed-seed-web-security-warn').show(); $('#org-seedstack-seed-seed-web-security-show').hide();">Show version</a>
            </small>
        </div>
        <div class="tab-pane in" id="tab-org-seedstack-seed-seed-web-security-gradle">
            <pre style="margin-top: 0; border: solid 1px #eee; border-top: none;"><code class="language-gradle no-linenums" style="background-color: #fff;">dependencies {
    compile(&quot;org.seedstack.seed:seed-web-security:3.15.1&quot;)
}</code></pre>
        </div>
    </div>
</div>


<h2 id="overview">Overview</h2>

<p>The OAuth 2.0 authorization framework is a protocol that allows a user to grant a third-party website or application
access to the user&rsquo;s protected resources, without necessarily revealing their long-term credentials or even their identity.</p>

<p>OpenID Connect (OIDC) is an identity layer built on top of the OAuth 2.0 framework. It allows third-party applications
to verify the identity of the end-user and to obtain basic user profile information. OIDC uses JSON web tokens (JWTs),
which you can obtain using flows conforming to the OAuth 2.0 specifications. See our OIDC Handbook for more details.</p>

<div class="callout callout-warning">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
            
                <i class="fa fa-exclamation-triangle icon-2x"></i>
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            
OAuth2/OpenIdConnect are complex protocols. While the SeedStack OAuth add-on greatly simplifies their use in applications,
a basic understanding of the roles, flows and security best practices is mandatory. 

        </div>
    </div>
</div>

<h3 id="roles">Roles</h3>

<p>An OAuth 2.0 flow has the following roles:</p>

<ul>
<li><strong>Resource Owner</strong>: entity that can grant access to a protected resource. Typically, this is the end-user.</li>
<li><strong>Resource Server</strong>: server hosting the protected resources. This is the API you want to access.</li>
<li><strong>Client</strong>: application requesting access to a protected resource on behalf of the Resource Owner.</li>
<li><strong>Authorization Server</strong>: server that authenticates the Resource Owner and issues access tokens after getting proper authorization.</li>
</ul>

<h3 id="use-cases">Use cases</h3>

<p>OAuth 2.0 defines four flows to get an access token. Deciding which one is suited for your case depends mostly on your
application type:</p>

<ul>
<li><strong>Traditional web application</strong>: use the <em>authorization code flow</em>. In this case the application server is the OAuth
client which request the tokens. It stores them in the web session, making the application stateful.</li>
<li><strong>Single-page application (SPA)</strong>: use the <em>authorization code flow with PKCE</em> which replaces the deprecated <em>implicit
grant flow</em>. In this case the SPA is the OAuth client which request the tokens. They are sent to one or more resource
server(s) in an HTTP <code>Authorization</code> header as Bearer tokens.</li>
<li><strong>Native mobile application</strong>: also use the <em>authorization code flow with PKCE</em>.</li>
<li><strong>Machine-to-Machine</strong>: use the <em>client credentials flow</em>. In this case, one of the machines acts as the OAuth client
and request tokens directly using its client credentials. No end-user is involved in this case. This is the functional
equivalent of a technical account.</li>
</ul>

<h2 id="usage">Usage</h2>

<p>The add-on comes with a few components that must be used according to the chosen OAuth flow:</p>

<ul>
<li>The <code>oauth</code> security filter. It&rsquo;s used in HTTP-based scenarios and protects URL patterns by requiring a valid access
token to let the request go trough. It is also responsible to redirect the end-user to the authorization server login
page in the <em>authorization code flow</em> scenario (when a callback URL is configured).</li>
<li>The <code>oauthCallback</code> security filter. It&rsquo;s also used in HTTP-based scenarios and should be placed on its own, on a
specific callback URL. It is responsible for exchanging the authorization code for tokens in the <em>authorization code
flow</em>.</li>
<li>The <code><a data-toggle="tooltip" data-html="true" title='org.&amp;#8203;seedstack.&amp;#8203;oauth.&amp;#8203;spi.&amp;#8203;OAuthService' href='http://seedstack.org/javadoc/org/seedstack/oauth/spi/OAuthService.html'>OAuthService</a></code>. It&rsquo;s used in programmatic cases like machine-to-machine
or custom scenarios to execute OAuth operations (like token resquest, validation, fetching user info, &hellip;) on demand. It
is used by the security filters, behind the scenes.</li>
<li>The <code>OAuthRealm</code> security realm. This realm will validate tokens, extract relevant data (claims) and map them to
SeedStack security data structures. It must be configured as soon as a SeedStack security context should be created from
tokens. It is used by the security filters, behind the scenes.</li>
</ul>

<h3 id="authorization-code-flow">Authorization code flow</h3>

<p>The following configuration is typical for traditional Web application using the <em>authorization code flow</em>:</p>

<pre><code class="language-yaml">rest:
  path: /api

security:
  realms: OAuthRealm
  web:
    urls:
      - pattern: /callback
        filters: oauthCallback
      - pattern: /api/**
        filters: oauth
  oauth:
    discoveryDocument: https://my-authorization-server.com/.well-known/openid-configuration
    redirect: ${runtime.web.baseUrl}/callback
    scopes: [openid, email, profile]
    clientId: ...
    clientSecret: ...
</code></pre>

<ul>
<li>The authorization server is configured through the OpenIDConnect discovery document. If this is not supported by your
authorization server, you&rsquo;ll have to configure the provider manually in the <code>security.oauth.provider</code> section (see below).</li>
<li>The redirect (callback) URL is configured, so you&rsquo;re in an <em>authorization code flow</em> situation.</li>
<li>The <code>oauth</code> filter will intercept any request to <code>/api/**</code> and check for an existing security context. If absent, it
will check for a bearer token and use it to establish the security context. If absent, it will redirect the request to
the authorization server login.</li>
<li>The <code>oauthCallback</code> filter will be redirected to by the authorization server upon a successful login. It will exchange the
authorization code for tokens and establish the security context, then redirect to the original request, which should then
be allowed.</li>
</ul>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            
The `openid` scope tells the add-on and the authorization server to exchange using the OpenIdConnect protocol. Alongside
the access token, an identity token will also be provided with identity information about the logged in subject.

        </div>
    </div>
</div>

<h3 id="authorization-code-with-pkce">Authorization code with PKCE</h3>

<p>The following configuration is typical for Single-Page Application (SPA) or mobile application, using the
<em>authorization code flow with PKCE</em>:</p>

<pre><code class="language-yaml">security:
  realms: OAuthRealm
  web:
    urls:
      - pattern: /**
        filters: oauth
  oauth:
    discoveryDocument: https://my-authorization-server.com/.well-known/openid-configuration
    scopes: [openid, email, profile]
    allowedAudiences: myApiAudience
</code></pre>

<ul>
<li>The authorization server is configured through the OpenIDConnect discovery document. If this is not supported by your
authorization server, you&rsquo;ll have to configure the provider manually in the <code>security.oauth.provider</code> section (see below).</li>
<li>The <code>oauth</code> filter will intercept any request to <code>/api/**</code> and check for an existing security context. If absent, it
will check for a bearer token and use it to establish the security context. If absent, it will deny the request.</li>
<li>The <code>allowedAudiences</code> specifies which audience(s) (access token <code>aud</code> claim) will be allowed.</li>
</ul>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            
The `openid` scope tells the add-on and the authorization server to exchange using the OpenIdConnect protocol. Alongside
the access token, an identity token will also be provided with identity information about the logged in subject.

        </div>
    </div>
</div>

<h3 id="client-credentials-flow">Client-credentials flow</h3>

<p>The following configuration is typical in machine-to-machine scenarios, using the <em>client-credentials flow</em>:</p>

<pre><code class="language-yaml">security:
  realms: OAuthRealm
  oauth:
    discoveryDocument: https://my-authorization-server.com/.well-known/openid-configuration
    scopes: [openid, email, profile]
    clientId: sXpRGGxj3N6ETt0m63Wji161PiBsJVuh
    clientSecret: Jn2jAXp6mfa8-sKS3C29FwbXSeD5gIKkrlFG_vUq0IXhxwZOAULL2y4ucnbSD3gF
    allowedAudiences: myApiAudience
</code></pre>

<ul>
<li>No security web filter is involved in this scenario.</li>
<li>The <code>allowedAudiences</code> specifies which audience(s) (access token <code>aud</code> claim) will be allowed.</li>
</ul>

<p>To programmatically request tokens using client credentials, use the following code:</p>

<pre><code class="language-java">public class SomeClass {
    @Inject
    private OAuthService oAuthService;
    @Inject
    private SecuritySupport securitySupport;
    
    public void someMethod() {
        OAuthAuthenticationToken tokens = oAuthService.requestTokensWithClientCredentials(&quot;email&quot;, &quot;profile&quot;);

        // Option 1: call a remote API
        String bearerToken = &quot;Bearer &quot; + tokens.getAccessToken();

        // Option 2: login locally
        securitySupport.login(tokens);
    }   
}
</code></pre>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            
We are not specifying the `openid` scope here because OpenIdConnect is often not supported in the *client credentials
flow*, as there is no subject to be authenticated. 

        </div>
    </div>
</div>

<p>From there you have two options:</p>

<ul>
<li>Option 1: use the <code>getAccessToken()</code> method on the returned object to access a protected resource, like a remote API.</li>
<li>Option 2: use the returned object to login locally using <code>securitySupport.login(tokens)</code> method.</li>
</ul>

<h2 id="all-configuration-options">All configuration options</h2>

<p>All configuration options are described below:</p>


<div class="tab-v2">
    <ul class="nav nav-tabs">
        <li class="active"><a href="#tab-security-oauth-config" data-toggle="tab" aria-expanded="true">Configuration</a></li>
        <li class=""><a href="#tab-security-oauth-dump" data-toggle="tab" aria-expanded="true">Tool</a></li>
    </ul>
    <span class="tabs-icon fa-2x fa fa-wrench pull-right"></span>
    <div class="clear-both"></div>
    <div class="tab-content" style="padding-top: 0;">
        <div class="tab-pane in active" id="tab-security-oauth-config"><pre><code class="language-yaml">security:
  oauth:
    # This url defines how clients dynamically discover information about authorization server.
    discoveryDocument: (Absolute url as a String)

    # This sections allows to manually configure the provider details (and/or override discovered information)
    provider:
      # Authorization endpoint
      authorization: (Absolute url as a String)
      # Token endpoint
      token: (Absolute url as a String)
      # Revocation endpoint
      revocation: (Absolute url as a String)
      # User info endpoint
      userInfo: (Absolute url as a String)
      # JWKS url
      jwks: (Absolute url as a String)
      # Issuer
      issuer: (String)

    # This sections allows to manually configure accepted cryptographic algorithms
    algorithms:
      # Access token signing algorithm (RS256 by default)
      accessSigningAlgorithm: (String)
      # Id token signing algorithm (RS256 by default)
      idSigningAlgorithm: (String)
      # If true, unsecured (unsigned) tokens are accepted (false by default) 
      plainTokenAllowed: (boolean)

    # Redirection URI when configured for authorization code flow
    redirect: (Absolute url in String format)

    # Client identifier when the application acts as OAuth/OpenIdConnect client
    clientId: (String)
    # Client secret when the application acts as OAuth/OpenIdConnect client
    clientSecret: (String)
    # Requested scopes when the application acts as OAuth/OpenIdConnect client
    scopes: (List of comma separated String values)
  
    # Required claims in the access token ([&quot;sub&quot;] by default)
    requiredClaims: (Set&lt;String&gt;)
    # Prohibited claims in the access token (empty set by default)
    prohibitedClaims: (Set&lt;String&gt;)
    # Allowed audiences for the access token (&quot;aud&quot; claim, empty set by default)
    allowedAudiences: (Set&lt;String&gt;)
    # Custom parameters to be sent to the authorization server when requesting tokens (as query params)
    customParameters: (Map&lt;String, List&lt;String&gt;&gt;)

    # Class implementing validation for opaque access tokens (default to userInfo request if endpoint is configured)
    accessTokenValidator: (Class&lt;? extends AccessTokenValidator&gt;)
    # If true, the user info endpoint will be requested if it is configured to enrich principals with subject personal claims (false by default)
    autoFetchUserInfo: (boolean)
    # If true, the scopes will be treated as realm roles instead of direct subject permissions roles (false by default)
    treatScopesAsRoles: (boolean)
</code></pre>
</div>
        <div class="tab-pane in" id="tab-security-oauth-dump">
            <p style="margin-top: 20px;">To dump the <code>security.oauth</code> configuration options:</p>
            <pre><code class="language-bash">mvn -q -Dargs="security.oauth" seedstack:config</code></pre>
        </div>
    </div>
</div>


<h2 id="examples">Examples</h2>

<p>Working examples for the three common scenarios described in this page are available at <a href="https://github.com/seedstack/samples/tree/master/addons/oauth">https://github.com/seedstack/samples/tree/master/addons/oauth</a>.</p>

<h2 id="advanced-configuration">Advanced configuration</h2>

<h3 id="scopes-interpretation">Scopes interpretation</h3>

<p>By default the add-on will treat OAuth scopes as subject permission (like <code>order:refund</code>, <code>product:edit</code>, &hellip;). While this is the obvious interpretation of the OAuth protocol, it bypasses the usual SeedStack roles/permissions mapping mechanism. If you want to use this mechanism, set the <code>treatScopesAsRoles</code> option to <code>true</code>:</p>

<pre><code class="language-yaml">oauth:
    treatScopesAsRoles: true
</code></pre>

<p>Scopes will then be used as realm roles that can be <a href="http://seedstack.org/docs/core/security/#role-mapper">mapped to applicative roles</a>, which in turn can be <a href="http://seedstack.org/docs/core/security/#permission-resolver">resolved to permissions</a>.</p>

<h3 id="audiences">Audiences</h3>

<p>It is good practice to only allow OAuth tokens that are intended for your application or API. In that spirit, the token validation mechanism has a default audience check: it will only allow tokens that have an <code>aud</code> containing the application identifier (<code>application.id</code> config option). You cannot always make the application id match the <code>aud</code> claim, so you can override the allowed audiences like this:</p>

<pre><code class="language-yaml">oauth:
    allowedAudiences: [ 'myAudience' ]
</code></pre>

<p>If you want to allow tokens without audience, add a null to the set of allowed audiences:</p>

<pre><code class="language-yaml">oauth:
    allowedAudiences: [ ~ ]
</code></pre>

            </div>
        </div>
    </div>
</div>

</div>
<div id="toc">
    <div class="toc" data-spy="affix" data-offset-top="314" data-offset-bottom="336">
    <div>
        
    </div>
    <br/>
    <div>
        <p class="title">On this page</p>
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#overview">Overview</a>
<ul>
<li><a href="#roles">Roles</a></li>
<li><a href="#use-cases">Use cases</a></li>
</ul></li>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#authorization-code-flow">Authorization code flow</a></li>
<li><a href="#authorization-code-with-pkce">Authorization code with PKCE</a></li>
<li><a href="#client-credentials-flow">Client-credentials flow</a></li>
</ul></li>
<li><a href="#all-configuration-options">All configuration options</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#advanced-configuration">Advanced configuration</a>
<ul>
<li><a href="#scopes-interpretation">Scopes interpretation</a></li>
<li><a href="#audiences">Audiences</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
    <br/>
    <div>
        
        
        
        <a href='https://github.com/seedstack/oauth-addon/edit/docs/index.md' target="_blank"><i class="fa fa-edit"></i> Edit this page</a>
        
        
    </div>
</div>
</div>
<div id="footer">
    <a class="scrollup">Scroll</a>
<div class="footer-v3">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 md-margin-bottom-40">
                    <div class="headline"><h2>About</h2></div>
                    <p class="margin-bottom-25 md-margin-bottom-40">
                        SeedStack is an opinionated, easy-to-use Java development stack for building applications and micro-services.
                    </p>
                    <p>
                        <i class="fa fa-file-text"></i> <a target="_blank" href="http://seedstack.org/docs">Docs</a>
                        <i class="fa fa-info-circle"></i> <a target="_blank" href="http://seedstack.org/javadoc">Javadoc</a>
                        <i class="fa fa-book"></i> <a target="_blank" href="http://seedstack.org/guides">Guides</a>
                        <i class="fa fa-plug"></i> <a target="_blank" href="http://seedstack.org/addons">Add-ons</a>
                        <br/>
                        <i class="fa fa-keyboard-o"></i> <a style="cursor: pointer;" onclick="seedstack.ui.openHelp();">Keyboard shortcuts</a>
                    </p>
                </div>

                <div class="col-md-4 md-margin-bottom-40">
                    <div class="posts">
                        <div class="headline"><h2>License and credits</h2></div>
                        <p>
                            Code licensed under the <a href="https://www.mozilla.org/MPL/2.0" target="_blank">Mozilla Public License 2.0</a>.
                            <br/>
                            Documentation licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.
                            <br/>
                            Some illustrations by <a href="https://www.Vecteezy.com/">www.Vecteezy.com</a>
                        </p>
                    </div>
                </div>

                <div class="col-md-4 map-img">
                    <div class="headline"><h2>Contact us</h2></div>
                    <address>
                        <p>
                            <i class="fa fa-stack-overflow"></i> <a target="_blank" href="http://stackoverflow.com/questions/ask?tags=seedstack">StackOverflow</a>
                            <br/>
                            <i class="fa fa-comments"></i> <a target="_blank" href="https://kiwiirc.com/client/irc.freenode.net#seedstack">IRC</a>
                            <br/>
                            <i class="fa fa-github"></i> <a target="_blank" href="https://github.com/seedstack">GitHub</a>
                            <br/>
                            <i class="fa fa-link"></i> <a target="_blank" href="https://projects.ow2.org/bin/view/seedstack/">OW2</a>
                        </p>
                    </address>

                    <div class="headline"><h2>Stay in touch</h2></div>
                    <div style="margin-bottom: 20px;">
                        <a class="twitter-follow-button"
                           href="https://twitter.com/seedstack"
                           data-show-count="false"
                           data-size="large"
                           data-lang="en">
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>
<div id="hotkeys-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Keyboard shortcuts</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table class="keyboard-mappings">
                            <tbody>
                            <tr>
                                <td class="keys">
                                    <kbd>?</kbd>
                                </td>
                                <td>Show this help dialog</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>/</kbd>
                                </td>
                                <td>Focus the search field</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-left"></i></kbd>
                                </td>
                                <td>Go to previous page</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-right"></i></kbd>
                                </td>
                                <td>Go to next page</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>d</kbd>
                                </td>
                                <td>Go to documentation</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>a</kbd>
                                </td>
                                <td>Go to add-ons library</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>g</kbd>
                                </td>
                                <td>Go to guides list</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="versions-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 id="versions-title" class="modal-title">Fetching components...</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table id="versions-table" class="table table-striped table-hover table-bordered">
                            <tr>
                                <th>Component</th>
                                <th>Version</th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/idea.min.css">

<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/gradle.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.1.0/highlightjs-line-numbers.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/seedstack.js"></script>
<script>
    $(document).ready(function () {
        var $search = $('.search-btn');

        $('.search').click(function () {
            if ($search.hasClass('fa-search')) {
                seedstack.ui.openSearch();
            } else {
                seedstack.ui.closeSearch();
            }
        });

        function hideJavaImports(block) {
            $(block).filter('.language-java')
                .find('table > tbody > tr')
                .each(function (i, javaLine) {
                    var $javaLine = $(javaLine);
                    var code = $javaLine.find("td.hljs-ln-code div.hljs-ln-line").text();
                    if (/^package/.test(code) || /^import/.test(code) || code.trim().length === 0) {
                        $javaLine.hide();
                    } else {
                        return false;
                    }
                });
        }

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);

            if ($(block).not('.no-linenums').length > 0) {
                hljs.lineNumbersBlock(block);
                
                var lastLine = $(block).find('table > tbody > tr:last');
                if (lastLine.text().trim() === "") {
                    lastLine.remove();
                }
            }

            
            hideJavaImports(block);
        });

        
        $('.doc-content h2, .doc-content h3').each(function () {
            $(this).append(" <a class='title-anchor' href='#" + this.id + "'>#</a>");
        });

        Mousetrap.bind('/', function () {
            seedstack.ui.openSearch();
            return false;
        });

        Mousetrap.bind('left', function () {
            if (seedstack.state.previousPage) {
                window.location = seedstack.state.previousPage;
            }
            return false;
        });

        Mousetrap.bind('right', function () {
            if (seedstack.state.nextPage) {
                window.location = seedstack.state.nextPage;
            }
            return false;
        });

        Mousetrap.bind('?', function () {
            seedstack.ui.openHelp();
            return false;
        });

        Mousetrap.bind('esc', function () {
            seedstack.ui.closeHelp();
            seedstack.ui.closeSearch();
            seedstack.ui.closeVersions();
            return false;
        });

        var originalCallback = Mousetrap.stopCallback;
        Mousetrap.stopCallback = function (e, element, combo) {
            if (combo === 'esc') {
                return false;
            }

            return originalCallback(e, element, combo);
        };

        function bindShortcuts(value) {
            $.each(value, function (sequence, item) {
                if (typeof item === 'string') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item;
                        return false;
                    });
                } else if (typeof item === 'object') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item.path;
                        return false;
                    });
                    if (item.shortcuts && location.pathname.indexOf(item.path) === 0) {
                        bindShortcuts(item.shortcuts);
                    }
                }
            });
        }

        bindShortcuts(seedstack.ui.shortcuts);

        $('.quick-paste span').each(function (index, element) {
            $(element).attr({"id": "quick-paste-line"});
            $(element).append("<span data-toggle=\"tooltip\" data-placement=\"top\" data-title=\"Copy\" data-clipboard-target=\"#quick-paste-line\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var preId = 0;
        $('.doc-content pre').each(function (index, element) {
            preId++;
            $(element).attr({"id": "snippet-" + preId});
            $(element).prepend("<span data-toggle=\"tooltip\" data-placement=\"left\" data-title=\"Copy\" data-clipboard-target=\"#snippet-" + preId + "\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var clipboard = new Clipboard('.copy-button', {
            target: function (trigger) {
                var elt = $($(trigger).data('clipboard-target'));
                elt.find('code > table > tbody > tr').show();
                return elt.get(0);
            }
        });
        clipboard.on('success', function (e) {
            var elt = $($(e.trigger).data('clipboard-target'));
            hideJavaImports($(elt).children("code"));

            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=14px');
            tooltip.children(".tooltip-inner").html("Copied!");
            e.clearSelection();
        });
        clipboard.on('error', function (e) {
            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=83px');
            tooltip.children(".tooltip-inner").html("Error! Copy manually");
        });

        $('[data-toggle="tooltip"]').tooltip({
            container: 'body'
        });

        $('#hotkeys-modal, #versions-modal').bind('hidden.bs.modal', function () {
            $("html").css("margin-right", "0px");
        }).bind('show.bs.modal', function () {
            $("html").css("margin-right", "-15px");
        });

        var query = seedstack.strings.parseQueryString(location);
        if (query.h && query.h.length > 0) {
            $('.doc-content').highlight(query.h);
            if (query.scroll) {
                var firstOccurence = $('span[class=highlight]:first');
                if (firstOccurence.length > 0) {
                    $('html, body').animate({
                        scrollTop: firstOccurence.offset().top - 20
                    }, 250);
                }
            }
        }

        $(window).scroll(function () {
            if ($(this).scrollTop() > 200) {
                $('.scrollup').fadeIn();
            } else {
                $('.scrollup').fadeOut();
            }
        });

        $('.scrollup').click(function () {
            $("html, body").animate({scrollTop: 0}, 250);
            return false;
        });
    });
</script>
<script>window.twttr = (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
    t._e = [];
    t.ready = function (f) {
        t._e.push(f);
    };
    return t;
}(document, "script", "twitter-wjs"));</script>

</body>
</html>
