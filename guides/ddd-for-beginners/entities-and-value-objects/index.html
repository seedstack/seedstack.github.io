<!DOCTYPE html>
<html lang="en">
<head>
    
    


    


<title>
    Entities and Value Objects
</title>
<meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">



<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,700,300,400" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/css/style.css">
<link rel="stylesheet" href="http://seedstack.org/assets/unify/plugins/font-awesome/css/font-awesome.css">
<link rel="stylesheet" href="http://seedstack.org/css/style.css">



<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "url": "http://seedstack.org",
  "logo": "http://seedstack.org/img/logos/seedstack.png"
}
</script>



<meta property="og:title" content='Entities and Value Objects' />
<meta property="og:description" content="Modeling business concepts with objects may seem very intuitive at first sight but there are a lot of difficulties
awaiting us in the details. To clarify the meaning of model elements and propose a set of design practices, Domain-Driven
Design defines three patterns that express the model: Entities, Value Objects and Services. This chapter will focus
on Entities and Value Objects, leaving Services for their own chapter." />
<meta property="og:url" content="http://seedstack.org/guides/ddd-for-beginners/entities-and-value-objects/" />
<meta property="og:site_name" content="SeedStack" />
<meta property="og:image" content="http://seedstack.org/img/opengraph.png" />



<link rel="search" type="application/opensearchdescription+xml" href="http://seedstack.org/opensearch.xml" title="SeedStack" />



<link rel="apple-touch-icon" sizes="57x57" href="http://seedstack.org/img/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="http://seedstack.org/img/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="http://seedstack.org/img/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://seedstack.org/img/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="http://seedstack.org/img/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://seedstack.org/img/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="http://seedstack.org/img/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://seedstack.org/img/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://seedstack.org/img/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-194x194.png" sizes="194x194">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="http://seedstack.org/img/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="http://seedstack.org/img/favicons/manifest.json">
<meta name="apple-mobile-web-app-title" content="SeedStack">
<meta name="application-name" content="SeedStack">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-TileImage" content="/img/favicons/mstile-144x144.png">
<meta name="theme-color" content="#ffffff">



<script type="text/javascript">
    window.seedstack = {
        baseUrl: "http:\/\/seedstack.org\/",
        state: {}
    };
</script>


</head>
<body>

<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5R5FP9"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5R5FP9');</script>


<div id="header">
    
    

<div class="header">
    <div class="container">
        <a class="logo" href="http://seedstack.org/">SeedStack</a>
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="fa fa-bars"></span>
        </button>
    </div>
    <div class="collapse navbar-collapse navbar-responsive-collapse" data-role="navigation" style="pointer-events: none;">
        <div class="container">
            <ul class="nav navbar-nav" style="pointer-events: auto;">
                <li class=''>
                    <a href="http://seedstack.org/docs">Documentation</a>
                </li>
                <li class='active'>
                    <a href="http://seedstack.org/guides">Guides</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/addons">Add-ons</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/posts">News</a>
                </li>
                <li class=''>
                    <a href="http://seedstack.org/community">Community</a>
                </li>
                <li class='dropdown '>
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown">
                        More
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="http://seedstack.org/glossary">Glossary</a></li>
                        <li><a href="http://seedstack.org/tags">Tags</a></li>
                        <li><a href="http://seedstack.org/project">Project info</a></li>
                        <li><a target="_blank" href="http://seedstack.org/javadoc"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Javadoc</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack/distribution/releases"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> Releases</a></li>
                        <li><a target="_blank" href="https://github.com/seedstack"><i style="margin-top: 3px" class="pull-right fa fa-external-link"></i> GitHub</a></li>
                    </ul>
                </li>
                <li>
                    <i class="search fa fa-search search-btn"></i>
                    <div class="search-open">
                        <form method="GET" action="http://seedstack.org/search">
                            <div class="input-group animated fadeInDown">
                                <input id="search-field" type="text" class="form-control" placeholder="Search" name="q">
                                <span class="input-group-btn">
                                    <button class="btn-u" type="submit">Go</button>
                                </span>
                            </div>
                        </form>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>


    <div class="title-header small">
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-sm-12">
                <h1>Guides</h1>
                <p class="hidden-xs">Hands-on guides and articles about SeedStack.</p>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
                <div class="header-image-wrapper">
                    <img class="header-image" src="http://seedstack.org/img/logos/guides-logo.svg">
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="title-subheader">
        <div class="container">
            <ul>
                <li><span><i class="fa fa-chevron-left"></i> <a href="http://seedstack.org/guides">Back to list</a></span></li>
                
                <li class="pull-right">
                    <span class="menu-toggle" style="" data-toggle="collapse" data-target=".side-menu-collapse">
    <span class="sr-only">Toggle menu</span>
    <i class="fa fa-bars"></i>
</span>

                </li>
                
            </ul>
        </div>
    </div>
</div>
<div id="content" class="container">
    <div class="row">
    
    <div class="col-md-3">
        










<nav class="side-menu collapse side-menu-collapse" data-role="navigation">
    <div class="list-group">
        <ul class="nav">
            
            
            <li class="list-group-header">
                <a href="/guides/ddd-for-beginners/" class=" active" data-target=".contents">Contents</a>
            </li>
            
            <li class="list-group-item">
                <ul>
                    
                    
                    <li>
                        
                        <a href="/guides/ddd-for-beginners/" class="">
                            Introduction
                        </a>
                        
                    </li>
                    
                    
                    
                        
                        <script>
                            seedstack.state.previousPage = '\/guides\/ddd-for-beginners\/';
                        </script>
                    
                    
                    
                    <li>
                        
                        <a href="/guides/ddd-for-beginners/anemic-domain-model/" class="">
                            Anemic Domain Model
                        </a>
                        
                    </li>
                    
                    
                    
                        
                        <script>
                            seedstack.state.previousPage = '\/guides\/ddd-for-beginners\/anemic-domain-model\/';
                        </script>
                    
                    
                    
                    <li>
                        
                        <a href="/guides/ddd-for-beginners/entities-and-value-objects/" class="active">
                            Entities and Value Objects
                        </a>
                        
                    </li>
                    
                    
                        
                        
                    
                    
                    
                    
                    <li>
                        
                        <a href="/guides/ddd-for-beginners/aggregate-design/" class="">
                            Aggregate Design
                        </a>
                        
                    </li>
                    
                        
                        
                        <script>
                            seedstack.state.nextPage = '\/guides\/ddd-for-beginners\/aggregate-design\/';
                        </script>
                    
                    
                    
                    
                    
                    <li>
                        
                        <a href="/guides/ddd-for-beginners/behavior-and-services/" class="">
                            Behavior and Services
                        </a>
                        
                    </li>
                    
                    
                    
                    
                </ul>
            </li>
            
            </li>
            
        </ul>
    </div>
</nav>



    </div>
    <div class="col-md-9">
    
        <div class="content-wrapper">
            <div class="doc-content">
                <h1 class="nocount">Entities and Value Objects</h1>
                <p>Modeling business concepts with objects may seem very intuitive at first sight but there are a lot of difficulties
awaiting us in the details. To clarify the meaning of model elements and propose a set of design practices, Domain-Driven
Design defines three patterns that express the model: Entities, Value Objects and Services. This chapter will focus
on Entities and Value Objects, leaving Services for their <a href="http://seedstack.org/guides/ddd-for-beginners/behavior-and-services/">own chapter</a>.</p>

<h2 id="entities">Entities</h2>

<p>An object having a specific identity and defined primarily by it is called an Entity. We model a domain concept as an
Entity when its individuality is primordial and it must be distinguished from other objects in the system. There is a
notion of continuity in Entities, as they can change drastically throughout their lifecycle, yet they remain uniquely
identified.</p>

<p>Entities don&rsquo;t need to be tied to an identifiable real-world concept, as their name could imply. They can be anything
that need to be tracked in the system, regardless of their attributes.</p>

<h3 id="identity">Identity</h3>

<p>When designing an Entity, the focus should be put first on its primary attributes and behaviors that contribute to
its identity. There is a tendency, especially for DDD beginners, to focus on data and define all the attributes
of a domain object. This should be delayed until all the aspects of the Entity identity have been considered and
settled. One should first consider how the identity is obtained.</p>

<h4 id="user-provided-identity">User-provided identity</h4>

<p>The user could input one or more unique values into the application to be used as an identity, which in turn should
ensure that they have the required qualities:</p>

<ul>
<li>Correctness. The provided values should adequately identify the Entity without ambiguity.</li>
<li>Uniqueness. The provided values should be unique among all the entities of the same type.</li>
<li>Immutable. Most of the time the identity must be immutable because the cost of changing an identity may be very high.</li>
</ul>

<h4 id="application-generated-identity">Application-generated identity</h4>

<p>The application could internally generate an identity using an algorithm that provide unique values. The Business
framework provides an API that can delegate the identity generation to any specified implementation at Entity creation.
This is called <strong>early identity generation</strong> because identity is assigned <em>before</em> the Entity can be used in the
application. This requires the Entity identity attribute to be annotated with <code>@Identity</code>:</p>

<pre><code>public class MyEntity extends BaseEntity&lt;Long&gt; {

    @Identity(handler = SequenceHandler.class)
    private Long id;

    // ... other attributes and methods

}
</code></pre>

<p>The factory method which create the entity must be annotated with <code>@Create</code>:</p>

<pre><code>@Create
MyEntity createMyEntity() {
    return new MyEntity();
}
</code></pre>

<p>Here, the specified handler class (<code>SequenceHandler</code>) is an interface so configuration is required to specify the qualifier
of the implementation (it could be <code>oracle-sequence</code> for instance) and the additional implementation properties (like a
sequence name). For more information, refer to the <a href="http://seedstack.org/docs/business/factories/#identity">documentation</a>.</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>This mechanism can be used to delegate the identity generation to a specific technology without tainting your domain (by
keeping the handler implementation in the infrastructure). But it also can be used to simply reuse a pure domain generation
logic across multiple Entity types.</p>

        </div>
    </div>
</div>

<h4 id="persistence-generated-identity">Persistence-generated identity</h4>

<p>The application waits until a persistence mechanism affects an identity to the persisted Entity. This is called <strong>late
identity generation</strong> and is <strong>less than ideal</strong> because an Entity won&rsquo;t have any identity and, as such, will be invalid
until it is persisted. It is strongly recommended to use the business framework identity generation mechanism instead,
which can delegate the generation to the persistence without compromising entity validity.</p>

<h4 id="externally-generated-identity">Externally-generated identity</h4>

<p>Another <a href='/glossary#bounded-context'>Bounded Context</a> (like another application) has already an identity or a list of identities which
the user can choose from. This is the most complex identity creation strategy as it involves one or more external systems.
The Business framework identity generation mechanism can help by allowing to encapsulate this complex logic into a custom
<code>IdentityGenerator</code>.</p>

<h4 id="surrogate-identity">Surrogate identity</h4>

<p>It is sometimes necessary to define a surrogate identity, mainly for certain persistence mechanisms that do not deal
with complex identities. In this case, we need to use two identities: one for the persistence tool which should be hidden
from the rest of the domain and one for the domain which is used throughout the system. The surrogate identity can often
be hidden by using a <code>private</code> or <code>protected</code> visibility as most persistence tools are able to deal with it.</p>

<div class="callout callout-warn">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>A surrogate identity is not something desirable and should only be used in last resort.</p>

        </div>
    </div>
</div>

<h3 id="equality">Equality</h3>

<p>Entity equality should <strong>always</strong> be based on the comparison of the type and the identity only. The Business framework
<code>BaseEntity</code> base class already implements this equality mechanism. If you choose to implement the <code>Entity</code> interface
directly or just annotate you class with <code>DomainEntity</code> instead, be sure to implement compliant <code>equals()</code> and <code>hashCode()</code>
methods.</p>

<h2 id="value-objects">Value Objects</h2>

<p>An object that don&rsquo;t have a conceptual identity but is just describing some characteristics of a thing is called a
Value Object. Because the most visible objects in a model are usually Entities, there is a natural tendency to assign
an identity to every domain object. But this tendency should be refrained. Here are the main characteristics of a
Value Object:</p>

<ul>
<li>It measures, quantifies or describes a thing in the domain.</li>
<li>It is immutable, meaning that its state cannot be changed after creation.</li>
<li>It describes a conceptual whole. Its attributes are related to each other and are all participating to the description.
This means that all the required values should be assigned upon creation (i.e. in the constructor).</li>
<li>It is comparable to others using value equality.</li>
<li>Its behavior is side-effect free.</li>
</ul>

<h3 id="example">Example</h3>

<p>As an example, consider the following class:</p>

<pre><code>public class MonetaryValue {
    private final BigDecimal amount;
    private final String currency;

    public MonetaryValue(BigDecimal amount, String currency) {
        this.amount = amount;
        this.currency = currency;
    }

    // ... behavior methods         
}
</code></pre>

<p>A monetary value consists at least in an amount of money and the currency this amount is expressed in. These two
attributes cannot be separated without losing the meaning of this domain object. Moreover, if a thing would be worth
1000$, we would <em>not</em> expect it to have these two separate attributes, as it would muddle the model and its client would
have to know when and how to use <code>amount</code> and <code>currency</code> together. It would be vastly better to describe the worth as
a whole and only have an attribute of type <code>MonetaryValue</code>, especially if it can provide additional behavior to manipulate
it.</p>

<h3 id="immutability">Immutability</h3>

<p>One of the most important constraint of a Value Object is immutability. The object state cannot change after it has been
created. When a change is required a new instance of the Value Object is created, either from scratch or derived from
an existing instance. In this latter case, the object itself can provide methods to derive itself:</p>

<pre><code>public MonetaryValue add(MonetaryValue other) {
    if (!currency.equals(other.currency)) {
        throw new IllegalArgumentException(&quot;Cannot add two monetary values of different currency&quot;);
    }

    return new MonetaryValue(amount.add(other.amount), currency);
}
</code></pre>

<p>This method is said to be side-effect-free as it produces an output but without modifying its own state. This kind of
design allows to share any Value Object by reference throughout the system, improving performance without compromising
model integrity.</p>

<h3 id="simple-value-as-value-object">Simple value as Value Object</h3>

<p>Very often, we resort to primitive data types and Strings to describe a lot of the model attributes. This is sound when
these attributes are secondary to the model. But when considering attributes of first importance, they are better modeled
as Value Objects with only one attribute. For instance an email could be modeled as a String but it would be able to
provide a real meaning to it nor any behavior. Moreover, it would leak a vague concept in the model client code instead
of a clear, valid and useful one.</p>

<div class="callout callout-info">
    <div style="display:table; width: 100%">
        <div style="display:table-cell; width: 50px; vertical-align: middle;">
            
            
                <i class="fa fa-info-circle icon-2x" style="line-height: 30px;"></i>
            
            
            
            
            
        </div>
        <div style="display:table-cell; vertical-align: middle;">
            <p>Since identities are of crucial importance in the model, they can be modeled as Value Objects with great success.</p>

        </div>
    </div>
</div>

<h3 id="equality-1">Equality</h3>

<p>Value Object equality should <strong>always</strong> be based on the comparison of the type and the attributes values. The Business
framework <code>BaseValueObject</code> already implement this equality mechanism. If you choose to implement the <code>ValueObject</code>
interface directly or just annotate you class with <code>DomainValueObject</code> instead, be sure to implement compliant
<code>equals()</code> and <code>hashCode()</code> methods.</p>

<h3 id="persistence">Persistence</h3>

<p>Persisting Value Objects as part of referencing Entities can pose its challenges, especially with relational databases
and ORM.</p>

<h4 id="simple-references">Simple references</h4>

<p>When an entity holds a reference to a Value Object, there is basically two choices:</p>

<ul>
<li>The Value Object can be serialized in a format such as JSON or XML to a column of the Entity table. The inability to
execute queries referring to the contents of the Value Object can pose problem though.</li>
<li>The Value Object attributes can be stored independently as columns of the holding Entity table by using a mechanism
such as JPA <code>@Embeddable/@Embedded</code>. This is the preferred way because it preserves the ability to query the Value Object
attributes.</li>
</ul>

<p>In this case, whatever the method, the persistence of Value Objects is clean and optimized. No persistence store specifics
leaks in the model.</p>

<h4 id="collections">Collections</h4>

<p>Persisting a collection of Value Objects hold by an Entity is more difficult. Like in the single Value Object case, the
whole collection can still be serialized in a specific column although column-size problems can arise in addition to the
inability to query the collection contents. This mechanism may also require custom ORM code to handle the
serialization/deserialization process.</p>

<p>An alternative would to treat such Value Objects as Entities in the data model, by giving them an identity and their own
table. It would be crucial to hide this persistence-only identity from the rest of the domain and the system by using
visibility restrictions (private attribute) or other techniques.</p>
            </div>
        </div>
    </div>
</div>

</div>
<div id="toc">
    <div class="toc" data-spy="affix" data-offset-top="314" data-offset-bottom="336">
    <div>
        
        <div>
            
            <a href='/guides/ddd-for-beginners/anemic-domain-model/' class="dib f6 pr1 hover-bg-light-gray br-100" data-toggle="tooltip" title='Anemic Domain Model'>
                <i class="fa fa-chevron-left"></i>
            </a>
            
            &nbsp;&nbsp;&nbsp;
            
            <a href='/guides/ddd-for-beginners/aggregate-design/' class="dib f6 pl1 hover-bg-light-gray br-100" data-toggle="tooltip" title='Aggregate design'>
                <i class="fa fa-chevron-right"></i>
            </a>
            
        </div>
        
    </div>
    <br/>
    <div>
        <p class="title">On this page</p>
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#entities">Entities</a>
<ul>
<li><a href="#identity">Identity</a>
<ul>
<li><a href="#user-provided-identity">User-provided identity</a></li>
<li><a href="#application-generated-identity">Application-generated identity</a></li>
<li><a href="#persistence-generated-identity">Persistence-generated identity</a></li>
<li><a href="#externally-generated-identity">Externally-generated identity</a></li>
<li><a href="#surrogate-identity">Surrogate identity</a></li>
</ul></li>
<li><a href="#equality">Equality</a></li>
</ul></li>
<li><a href="#value-objects">Value Objects</a>
<ul>
<li><a href="#example">Example</a></li>
<li><a href="#immutability">Immutability</a></li>
<li><a href="#simple-value-as-value-object">Simple value as Value Object</a></li>
<li><a href="#equality-1">Equality</a></li>
<li><a href="#persistence">Persistence</a>
<ul>
<li><a href="#simple-references">Simple references</a></li>
<li><a href="#collections">Collections</a></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</nav>
    </div>
    <br/>
    <div>
        
        
        <a href="https://github.com/seedstack/website/edit/master/content/guides/ddd-for-beginners/entities-and-value-objects.md" target="_blank"><i class="fa fa-edit"></i> Edit</a>
        
    </div>
</div>
</div>
<div id="footer">
    <a class="scrollup">Scroll</a>
<div class="footer-v3">
    <div class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 md-margin-bottom-40">
                    <div class="headline"><h2>About</h2></div>
                    <p class="margin-bottom-25 md-margin-bottom-40">
                        SeedStack is an opinionated, easy-to-use Java development stack for building applications and micro-services.
                    </p>
                    <p>
                        <i class="fa fa-file-text"></i> <a target="_blank" href="http://seedstack.org/docs">Docs</a>
                        <i class="fa fa-info-circle"></i> <a target="_blank" href="http://seedstack.org/javadoc">Javadoc</a>
                        <i class="fa fa-book"></i> <a target="_blank" href="http://seedstack.org/guides">Guides</a>
                        <i class="fa fa-plug"></i> <a target="_blank" href="http://seedstack.org/addons">Add-ons</a>
                        <br/>
                        <i class="fa fa-keyboard-o"></i> <a style="cursor: pointer;" onclick="seedstack.ui.openHelp();">Keyboard shortcuts</a>
                    </p>
                </div>

                <div class="col-md-4 md-margin-bottom-40">
                    <div class="posts">
                        <div class="headline"><h2>License and credits</h2></div>
                        <p>
                            Code licensed under the <a href="https://www.mozilla.org/MPL/2.0" target="_blank">Mozilla Public License 2.0</a>.
                            <br/>
                            Documentation licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>.
                            <br/>
                            Some illustrations by <a href="https://www.Vecteezy.com/">www.Vecteezy.com</a>
                        </p>
                    </div>
                </div>

                <div class="col-md-4 map-img">
                    <div class="headline"><h2>Contact us</h2></div>
                    <address>
                        <p>
                            <i class="fa fa-stack-overflow"></i> <a target="_blank" href="http://stackoverflow.com/questions/ask?tags=seedstack">StackOverflow</a>
                            <br/>
                            <i class="fa fa-comments"></i> <a target="_blank" href="https://kiwiirc.com/client/irc.freenode.net#seedstack">IRC</a>
                            <br/>
                            <i class="fa fa-github"></i> <a target="_blank" href="https://github.com/seedstack">GitHub</a>
                            <br/>
                            <i class="fa fa-link"></i> <a target="_blank" href="https://projects.ow2.org/bin/view/seedstack/">OW2</a>
                        </p>
                    </address>

                    <div class="headline"><h2>Stay in touch</h2></div>
                    <div style="margin-bottom: 20px;">
                        <a class="twitter-follow-button"
                           href="https://twitter.com/seedstack"
                           data-show-count="false"
                           data-size="large"
                           data-lang="en">
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>
<div id="hotkeys-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Keyboard shortcuts</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table class="keyboard-mappings">
                            <tbody>
                            <tr>
                                <td class="keys">
                                    <kbd>?</kbd>
                                </td>
                                <td>Show this help dialog</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>/</kbd>
                                </td>
                                <td>Focus the search field</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-left"></i></kbd>
                                </td>
                                <td>Go to previous page</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd><i class="fa fa-arrow-right"></i></kbd>
                                </td>
                                <td>Go to next page</td>
                            </tr>
                            <tr style="height: 20px;"><td></td></tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>d</kbd>
                                </td>
                                <td>Go to documentation</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>a</kbd>
                                </td>
                                <td>Go to add-ons library</td>
                            </tr>
                            <tr>
                                <td class="keys">
                                    <kbd>g</kbd> <kbd>g</kbd>
                                </td>
                                <td>Go to guides list</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="versions-modal" class="modal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                        aria-hidden="true">&times;</span></button>
                <h4 id="versions-title" class="modal-title">Fetching components...</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12">
                        <table id="versions-table" class="table table-striped table-hover table-bordered">
                            <tr>
                                <th>Component</th>
                                <th>Version</th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/idea.min.css">

<script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/gradle.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.1.0/highlightjs-line-numbers.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/mousetrap/1.4.6/mousetrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.6.0/clipboard.min.js"></script>
<script src="/js/jquery.highlight.js"></script>
<script src="/js/seedstack.js"></script>
<script>
    $(document).ready(function () {
        var $search = $('.search-btn');

        $('.search').click(function () {
            if ($search.hasClass('fa-search')) {
                seedstack.ui.openSearch();
            } else {
                seedstack.ui.closeSearch();
            }
        });

        function hideJavaImports(block) {
            $(block).filter('.language-java')
                .find('table > tbody > tr')
                .each(function (i, javaLine) {
                    var $javaLine = $(javaLine);
                    var code = $javaLine.find("td.hljs-ln-code div.hljs-ln-line").text();
                    if (/^package/.test(code) || /^import/.test(code) || code.trim().length === 0) {
                        $javaLine.hide();
                    } else {
                        return false;
                    }
                });
        }

        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);

            if ($(block).not('.no-linenums').length > 0) {
                hljs.lineNumbersBlock(block);
                
                var lastLine = $(block).find('table > tbody > tr:last');
                if (lastLine.text().trim() === "") {
                    lastLine.remove();
                }
            }

            
            hideJavaImports(block);
        });

        
        $('.doc-content h2, .doc-content h3').each(function () {
            $(this).append(" <a class='title-anchor' href='#" + this.id + "'>#</a>");
        });

        Mousetrap.bind('/', function () {
            seedstack.ui.openSearch();
            return false;
        });

        Mousetrap.bind('left', function () {
            if (seedstack.state.previousPage) {
                window.location = seedstack.state.previousPage;
            }
            return false;
        });

        Mousetrap.bind('right', function () {
            if (seedstack.state.nextPage) {
                window.location = seedstack.state.nextPage;
            }
            return false;
        });

        Mousetrap.bind('?', function () {
            seedstack.ui.openHelp();
            return false;
        });

        Mousetrap.bind('esc', function () {
            seedstack.ui.closeHelp();
            seedstack.ui.closeSearch();
            seedstack.ui.closeVersions();
            return false;
        });

        var originalCallback = Mousetrap.stopCallback;
        Mousetrap.stopCallback = function (e, element, combo) {
            if (combo === 'esc') {
                return false;
            }

            return originalCallback(e, element, combo);
        };

        function bindShortcuts(value) {
            $.each(value, function (sequence, item) {
                if (typeof item === 'string') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item;
                        return false;
                    });
                } else if (typeof item === 'object') {
                    Mousetrap.bind("g " + sequence, function () {
                        window.location = item.path;
                        return false;
                    });
                    if (item.shortcuts && location.pathname.indexOf(item.path) === 0) {
                        bindShortcuts(item.shortcuts);
                    }
                }
            });
        }

        bindShortcuts(seedstack.ui.shortcuts);

        $('.quick-paste span').each(function (index, element) {
            $(element).attr({"id": "quick-paste-line"});
            $(element).append("<span data-toggle=\"tooltip\" data-placement=\"top\" data-title=\"Copy\" data-clipboard-target=\"#quick-paste-line\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var preId = 0;
        $('.doc-content pre').each(function (index, element) {
            preId++;
            $(element).attr({"id": "snippet-" + preId});
            $(element).prepend("<span data-toggle=\"tooltip\" data-placement=\"left\" data-title=\"Copy\" data-clipboard-target=\"#snippet-" + preId + "\" class=\"copy-button\"><i class=\"fa fa-clipboard\"></i></span>");
        });
        var clipboard = new Clipboard('.copy-button', {
            target: function (trigger) {
                var elt = $($(trigger).data('clipboard-target'));
                elt.find('code > table > tbody > tr').show();
                return elt.get(0);
            }
        });
        clipboard.on('success', function (e) {
            var elt = $($(e.trigger).data('clipboard-target'));
            hideJavaImports($(elt).children("code"));

            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=14px');
            tooltip.children(".tooltip-inner").html("Copied!");
            e.clearSelection();
        });
        clipboard.on('error', function (e) {
            var tooltip = $("body #" + $(e.trigger).attr("aria-describedby"));
            tooltip.css('left', '-=83px');
            tooltip.children(".tooltip-inner").html("Error! Copy manually");
        });

        $('[data-toggle="tooltip"]').tooltip({
            container: 'body'
        });

        $('#hotkeys-modal, #versions-modal').bind('hidden.bs.modal', function () {
            $("html").css("margin-right", "0px");
        }).bind('show.bs.modal', function () {
            $("html").css("margin-right", "-15px");
        });

        var query = seedstack.strings.parseQueryString(location);
        if (query.h && query.h.length > 0) {
            $('.doc-content').highlight(query.h);
            if (query.scroll) {
                var firstOccurence = $('span[class=highlight]:first');
                if (firstOccurence.length > 0) {
                    $('html, body').animate({
                        scrollTop: firstOccurence.offset().top - 20
                    }, 250);
                }
            }
        }

        $(window).scroll(function () {
            if ($(this).scrollTop() > 200) {
                $('.scrollup').fadeIn();
            } else {
                $('.scrollup').fadeOut();
            }
        });

        $('.scrollup').click(function () {
            $("html, body").animate({scrollTop: 0}, 250);
            return false;
        });
    });
</script>
<script>window.twttr = (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0], t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);
    t._e = [];
    t.ready = function (f) {
        t._e.push(f);
    };
    return t;
}(document, "script", "twitter-wjs"));</script>

</body>
</html>
